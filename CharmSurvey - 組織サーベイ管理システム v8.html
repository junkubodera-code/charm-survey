<!DOCTYPE html>
<!-- saved from url=(0245)file:///Users/junkubodera/Library/Application%20Support/Claude/local-agent-mode-sessions/db81965c-ca9c-4d30-afc8-5cd4181cae5d/8714616e-6bc5-4f48-ac54-33712040b8bb/local_b82112cd-2b71-49e8-9eb8-ea441a704962/outputs/charm_survey_v8_production.html -->
<html lang="ja"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CharmSurvey - çµ„ç¹”ã‚µãƒ¼ãƒ™ã‚¤ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v8</title>
    <script src="./CharmSurvey - çµ„ç¹”ã‚µãƒ¼ãƒ˜ã‚™ã‚¤ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v8_files/html2canvas.min.js"></script>
    <script src="./CharmSurvey - çµ„ç¹”ã‚µãƒ¼ãƒ˜ã‚™ã‚¤ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v8_files/html2pdf.bundle.min.js"></script>
    <script src="./CharmSurvey - çµ„ç¹”ã‚µãƒ¼ãƒ˜ã‚™ã‚¤ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v8_files/chart.min.js"></script>
    <script src="./CharmSurvey - çµ„ç¹”ã‚µãƒ¼ãƒ˜ã‚™ã‚¤ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v8_files/qrcode.min.js"></script>
    <script src="./CharmSurvey - çµ„ç¹”ã‚µãƒ¼ãƒ˜ã‚™ã‚¤ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v8_files/api.js"></script>
    <script src="./CharmSurvey - çµ„ç¹”ã‚µãƒ¼ãƒ˜ã‚™ã‚¤ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v8_files/pptxgen.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        .container {
            display: flex;
            height: calc(100vh - 60px);
        }

        .sidebar {
            width: 280px;
            background: linear-gradient(135deg, #1f4788 0%, #2d5aa4 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .sidebar-section {
            margin-bottom: 30px;
        }

        .sidebar-title {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            color: rgba(255,255,255,0.7);
            margin-bottom: 12px;
            letter-spacing: 1px;
        }

        .add-company-btn {
            width: 100%;
            padding: 10px;
            background-color: #ff6b6b;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 15px;
            transition: background-color 0.3s;
        }

        .add-company-btn:hover {
            background-color: #ff5252;
        }

        .company-item {
            padding: 12px;
            margin-bottom: 8px;
            background-color: rgba(255,255,255,0.1);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .company-item:hover {
            background-color: rgba(255,255,255,0.2);
        }

        .company-item.active {
            background-color: rgba(255,255,255,0.3);
            border-left-color: #ff6b6b;
            font-weight: 600;
        }

        .main-content {
            flex: 1;
            overflow-y: auto;
            background-color: white;
            border-radius: 8px 0 0 0;
            box-shadow: -2px 0 10px rgba(0,0,0,0.05);
        }

        .header {
            background: linear-gradient(135deg, #1f4788 0%, #2d5aa4 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .header-title {
            font-size: 24px;
            font-weight: 700;
        }

        .header-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 4px;
        }

        .content-tabs {
            display: flex;
            border-bottom: 2px solid #e8e8e8;
            padding: 0 20px;
            background-color: #fafafa;
        }

        .tab {
            padding: 15px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 15px;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }

        .tab:hover {
            color: #1f4788;
        }

        .tab.active {
            color: #1f4788;
            border-bottom-color: #ff6b6b;
        }

        .tab-content {
            display: none;
            padding: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: #1f4788;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e8e8e8;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }

        input[type="text"],
        input[type="date"],
        textarea,
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #1f4788;
            box-shadow: 0 0 0 3px rgba(31, 71, 136, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 60px;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-block;
        }

        .btn-primary {
            background-color: #1f4788;
            color: white;
        }

        .btn-primary:hover {
            background-color: #16365f;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn-success:hover {
            background-color: #218838;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            margin-bottom: 20px;
        }

        th {
            background-color: #f0f0f0;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #333;
            border-bottom: 2px solid #ddd;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        tbody tr:hover {
            background-color: #f9f9f9;
        }

        .link-display {
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 4px;
            font-size: 12px;
            word-break: break-all;
            margin-bottom: 10px;
            font-family: monospace;
        }

        .qr-container {
            display: inline-block;
            margin-top: 10px;
            padding: 10px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .question-block {
            background-color: #f9f9f9;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
            border-left: 4px solid #1f4788;
        }

        .question-label {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .respondent-row {
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .respondent-row:hover {
            background-color: #f0f8ff;
        }

        .respondent-details {
            display: none;
        }

        .respondent-details.open {
            display: table-row;
        }

        .respondent-answers {
            padding: 15px;
            background-color: #f9f9f9;
        }

        .answer-item {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e8e8e8;
        }

        .answer-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .answer-question {
            font-weight: 600;
            color: #1f4788;
            margin-bottom: 5px;
            font-size: 13px;
        }

        .answer-text {
            font-size: 13px;
            color: #666;
            line-height: 1.5;
            padding: 8px;
            background-color: white;
            border-left: 3px solid #ff6b6b;
            margin-bottom: 5px;
        }

        .answer-rating {
            font-size: 12px;
            color: #999;
        }

        .slide-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .slide-info {
            font-size: 14px;
            color: #666;
            font-weight: 600;
        }

        .slide-viewer {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 20px;
            min-height: 600px;
            margin-bottom: 20px;
        }

        .slide-content {
            background-color: white;
            padding: 40px;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            min-height: 500px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        .slide-title {
            font-size: 24px;
            font-weight: 700;
            color: #1f4788;
            margin-bottom: 20px;
            border-bottom: 2px solid #ff6b6b;
            padding-bottom: 15px;
        }

        .slide-section {
            margin-bottom: 15px;
        }

        .slide-subtitle {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .stat-box {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 4px;
            border-left: 4px solid #1f4788;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #1f4788;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
        }

        .comparison-table th {
            background-color: #f0f0f0;
            font-weight: 600;
        }

        .comparison-table td:first-child {
            text-align: left;
            font-weight: 600;
            background-color: #f9f9f9;
        }

        .insight-box {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }

        .insight-title {
            font-weight: 600;
            color: #856404;
            margin-bottom: 8px;
        }

        .insight-text {
            font-size: 13px;
            color: #856404;
            line-height: 1.5;
        }

        .action-list {
            list-style: none;
            margin-left: 0;
        }

        .action-list li {
            padding: 10px;
            margin-bottom: 8px;
            background-color: #f0f8ff;
            border-left: 3px solid #1f4788;
            font-size: 13px;
            line-height: 1.5;
        }

        .respondent-toggle-icon {
            display: inline-block;
            margin-left: 8px;
            color: #1f4788;
            font-weight: bold;
        }

        .inline-edit-textarea {
            width: 100%;
            min-height: 100px;
            font-family: inherit;
            padding: 10px;
            border: 2px solid #1f4788;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .inline-edit-buttons {
            display: flex;
            gap: 10px;
        }

        .distribution-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .url-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #f9f9f9;
        }

        .url-card-title {
            font-weight: 600;
            color: #1f4788;
            margin-bottom: 10px;
        }

        .url-card-content {
            font-size: 12px;
            line-height: 1.6;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .status-active {
            background-color: #d4edda;
            color: #155724;
        }

        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }

        @media print {
            .slide-controls {
                display: none;
            }

            .sidebar {
                display: none;
            }

            .container {
                height: auto;
            }

            .slide-viewer {
                page-break-after: always;
                border: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LEFT SIDEBAR -->
        <div class="sidebar">
            <div class="sidebar-section">
                <div style="font-size: 20px; font-weight: 700; margin-bottom: 10px;">ğŸ¯ CharmSurvey v8</div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">ä¼æ¥­ç®¡ç†</div>
                <button class="add-company-btn" onclick="showAddCompanyDialog()">+ æ–°è¦ä¼æ¥­è¿½åŠ </button>
                <div id="companyList">
                <div class="company-item active" style="display: flex; justify-content: space-between; align-items: center;">
                    <span onclick="selectCompany(&#39;sample-corp&#39;)" style="flex: 1; cursor: pointer;">ã‚µãƒ³ãƒ—ãƒ«æ ªå¼ä¼šç¤¾</span>
                    <button class="btn btn-sm" onclick="deleteCompany(&#39;sample-corp&#39;)" style="background-color: #dc3545; color: white; padding: 4px 8px; font-size: 11px; margin-left: 8px;">å‰Šé™¤</button>
                </div>
            </div>
            </div>
        </div>

        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- HEADER -->
            <div class="header">
                <div>
                    <div class="header-title" id="companyName">ã‚µãƒ³ãƒ—ãƒ«æ ªå¼ä¼šç¤¾</div>
                    <div class="header-subtitle" id="responseCount">18åã®å›ç­”è€…</div>
                </div>
            </div>

            <!-- TABS -->
            <div class="content-tabs">
                <button class="tab active" onclick="switchTab(&#39;respondents&#39;)">å›ç­”è€…ç®¡ç†</button>
                <button class="tab" onclick="switchTab(&#39;questions&#39;)">è³ªå•ç®¡ç†</button>
                <button class="tab" onclick="switchTab(&#39;distribution&#39;)">é…å¸ƒç®¡ç†</button>
                <button class="tab" onclick="switchTab(&#39;report&#39;)">ãƒ¬ãƒãƒ¼ãƒˆ</button>
            </div>

            <!-- TAB: RESPONDENTS -->
            <div id="respondents" class="tab-content active">
                <div class="section">
                    <div class="section-title">ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆé…å¸ƒ</div>
                    <div class="form-group">
                        <label>å›ç­”è€…å°‚ç”¨ãƒªãƒ³ã‚¯</label>
                        <div class="link-display" id="surveyLink">ãƒªãƒ³ã‚¯ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„</div>
                        <button class="btn btn-primary btn-sm" onclick="generateSurveyLink()" style="margin-right: 10px;">ãƒªãƒ³ã‚¯ç”Ÿæˆ</button>
                        <button class="btn btn-secondary btn-sm" onclick="copySurveyLink()">ã‚³ãƒ”ãƒ¼</button>
                        <button class="btn btn-secondary btn-sm" onclick="previewSurvey()">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                    </div>
                </div>

                <div class="section">
                    <div class="section-title">å›ç­”è€…ä¸€è¦§</div>
                    <table>
                        <thead>
                            <tr>
                                <th>æ°å</th>
                                <th>éƒ¨ç½²</th>
                                <th>å½¹è·</th>
                                <th>å…¥ç¤¾æ—¥</th>
                                <th>å›ç­”å†…å®¹</th>
                            </tr>
                        </thead>
                        <tbody id="respondentTable">
                <tr class="respondent-row" onclick="toggleRespondentDetails(0)">
                    <td>ç”°ä¸­å¤ªéƒ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>å–¶æ¥­éƒ¨</td>
                    <td>å–¶æ¥­èª²é•·</td>
                    <td>2020-01-15</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-0">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ™ã‚¤ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">é¡§å®¢ãƒ‡ãƒ¼ã‚¿åˆ†æã®ç²¾åº¦ãŒä»–ç¤¾æ¯”è¼ƒã§å„ªã‚Œã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ç¤¾å†…ã§ã‚‚ã€Œãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«ã€ã¨ã‚ˆãè¨€ã‚ã‚Œã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">é‡‘èæ©Ÿé–¢ãŒãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³çµŒå–¶ã«è»¢æ›ã—ãŸäº‹ä¾‹ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å¤§ä¼æ¥­å‘ã‘ã«ã¯ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¿…è¦ãªå ´åˆãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(1)">
                    <td>å±±ç”°èŠ±å­ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>å–¶æ¥­éƒ¨</td>
                    <td>å–¶æ¥­éƒ¨é•·</td>
                    <td>2019-03-20</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-1">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ä½¿ã„ã‚„ã™ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨å°å…¥ã®å®¹æ˜“ã•ãŒå·®åˆ¥åŒ–è¦å› </div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã€Œç°¡å˜ã«ä½¿ãˆã‚‹ã€ã¨ã„ã†è©•åˆ¤ãŒå¤šã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">è¤‡æ•°ã®é¡§å®¢ãŒå£²ä¸Šæ”¹å–„ã«ç¹‹ãŒã£ãŸ</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¸ã®å¯¾å¿œã«èª²é¡ŒãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(2)">
                    <td>ä½è—¤æ¬¡éƒ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>å–¶æ¥­éƒ¨</td>
                    <td>å–¶æ¥­ä¸»ä»»</td>
                    <td>2021-07-10</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-2">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ã‚µãƒ¼ãƒ™ã‚¤ãƒ„ãƒ¼ãƒ«</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å°å…¥ã«æ‰‹é–“ãŒã‹ã‹ã‚‹ãŒã€å°å…¥å¾Œã®åŠ¹æœãŒå¤§ãã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">äººã«ã‚ˆã£ã¦è¨€ã„æ–¹ãŒã°ã‚‰ã°ã‚‰ãªæ°—ãŒã™ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã„ãã¤ã‹äº‹ä¾‹ã¯çŸ¥ã£ã¦ã„ã‚‹ãŒè©³ã—ããªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒ“ã‚¸ãƒã‚¹ã«ã¯é«˜ã„ã®ã§ã¯ãªã„ã‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(3)">
                    <td>éˆ´æœ¨å¤ªéƒ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>å–¶æ¥­éƒ¨</td>
                    <td>å–¶æ¥­ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</td>
                    <td>2022-04-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-3">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">çµ„ç¹”ã®ã‚µãƒ¼ãƒ™ã‚¤ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚ˆãåˆ†ã‹ã‚‰ãªã„éƒ¨åˆ†ãŒå¤šã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚ã¾ã‚Šå…±é€šã®è¨€è‘‰ã‚’ä½¿ã£ã¦ã„ãªã„ã‚ˆã†ãªæ°—ãŒã™ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 1</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å…·ä½“çš„ãªäº‹ä¾‹ã‚’çŸ¥ã‚‰ãªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 1</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å¼±ã¿ã«ã¤ã„ã¦è€ƒãˆãŸã“ã¨ãŒãªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(4)">
                    <td>ä¼Šè—¤å¥å¤ª <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>å–¶æ¥­éƒ¨</td>
                    <td>å–¶æ¥­</td>
                    <td>2022-06-15</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-4">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ™ã‚¤ã‚·ã‚¹ãƒ†ãƒ </div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å®Ÿè£…ã®é€Ÿã•ã¨è‰¯ã„ã‚µãƒãƒ¼ãƒˆ</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å‰²ã¨ã€Œé€Ÿã„ã€ã¨ã„ã†è¨€è‘‰ãŒã‚ˆãå‡ºã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã„ãã¤ã‹è‰¯ã„äº‹ä¾‹ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒã‚„ã‚„é™å®šçš„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(5)">
                    <td>æ°´é‡ç¾å’² <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>å–¶æ¥­éƒ¨</td>
                    <td>å–¶æ¥­</td>
                    <td>2023-01-10</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-5">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">çµ±åˆå‹ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒå¼·ã¿</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å®šç¾©ãŒã‚„ã‚„æ›–æ˜§</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å¤‰åŒ–ã‚’è¦‹ãŸé¡§å®¢ãŒã„ã‚‹ã¯ãš</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">UIã®æ”¹å–„ä½™åœ°ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(6)">
                    <td>æ£®ç”°å½©å­ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨</td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨é•·</td>
                    <td>2018-05-10</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-6">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ã‚ªãƒ¼ã‚¬ãƒŠã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³æœ€é©åŒ–ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">AIãƒ™ãƒ¼ã‚¹ã®åˆ†æã¨çµ„ç¹”é–‹ç™ºã®èåˆãŒå·®åˆ¥åŒ–</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ç¤¾å†…ã§ã¯ã€Œçµ„ç¹”æ”¹é©ãƒ„ãƒ¼ãƒ«ã€ã¨çµ±ä¸€ã•ã‚Œã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">é¡§å®¢ã®çµ„ç¹”æ”¹é©ã«å¤§ããè²¢çŒ®ã—ãŸè¤‡æ•°äº‹ä¾‹ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å°å…¥å‰å¾Œã®æ–‡åŒ–çš„æŠµæŠ—ã¸ã®å¯¾å¿œãŒèª²é¡Œ</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(7)">
                    <td>ä¸­æ‘ã‚†ã‚Š <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨</td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°èª²é•·</td>
                    <td>2019-08-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-7">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">çµ„ç¹”æ”¹å–„ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒ›ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ç¶™ç¶šçš„ã‚µãƒãƒ¼ãƒˆ</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ å†…ã§ã‚‚ã€Œæ”¹å–„ãƒ„ãƒ¼ãƒ«ã€ã§çµ±ä¸€</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å¤§æ‰‹ä¼æ¥­ã‹ã‚‰ã®ãƒã‚¸ãƒ†ã‚£ãƒ–ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒå¤šã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å°è¦æ¨¡çµ„ç¹”ã§ã® ROI ãŒä¸æ˜ç­ãªå ´åˆãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 1</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(8)">
                    <td>ç”°æ‰€æ‹“ä¹Ÿ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨</td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°èª²é•·</td>
                    <td>2020-02-15</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-8">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ã‚¨ãƒ³ãƒ—ãƒ­ã‚¤ãƒ¤ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">EX é‡è¦–ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¨ç¶™ç¶šã‚µãƒãƒ¼ãƒˆ</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒãƒ¼ãƒ å†…ã§ã‚‚æ„è­˜ã¯é«˜ã„ãŒè¨€è‘‰ã®å®šç¾©ã¯æ›–æ˜§</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã„ãã¤ã‹æˆåŠŸäº‹ä¾‹ã‚’è¦‹ã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹æ™‚ã®åœ°åŸŸå·®ã¸ã®å¯¾å¿œ</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(9)">
                    <td>å²¡æœ¬ç¾å„ª <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨</td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ</td>
                    <td>2021-09-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-9">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">äººäº‹å‘ã‘ã‚µãƒ¼ãƒ™ã‚¤ãƒ„ãƒ¼ãƒ«</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å®‰ä¾¡ã•ã¨å°å…¥ã®ç°¡å˜ã•</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚ˆãåˆ†ã‹ã‚‰ãªã„ã¨ã„ã†äººã‚‚å¤šã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">èã„ãŸã“ã¨ãŒã‚ã‚‹ã‚ˆã†ãªæ°—ãŒã™ã‚‹ãŒè©³ã—ããªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—ãŒååˆ†ã§ãªã„å¯èƒ½æ€§</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(10)">
                    <td>é«˜æ©‹å¥ä¸€ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨</td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</td>
                    <td>2022-04-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-10">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ã‚µãƒ¼ãƒ™ã‚¤ãƒ»åˆ†æãƒ„ãƒ¼ãƒ«</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã¶ã£ã¡ã‚ƒã‘ã‚ˆãåˆ†ã‹ã‚‰ãªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒãƒ©ãƒãƒ©</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 1</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">èã„ãŸã“ã¨ãªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 1</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã»ã¼å…¨éƒ¨</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(11)">
                    <td>å‚å£æœ‰å¸Œ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨</td>
                    <td>ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°</td>
                    <td>2023-03-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-11">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½ãŒåˆ†ã‹ã‚Šã‚„ã™ã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å®šç¾©ãŒæƒã„ãã£ã¦ã„ãªã„éƒ¨åˆ†ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã„ãã¤ã‹å°å…¥äº‹ä¾‹ã‚’èã„ã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ¬ãƒãƒ¼ãƒˆãŒé™å®šçš„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(12)">
                    <td>éˆ´æœ¨èŠ±å­ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ä¼ç”»éƒ¨</td>
                    <td>ä¼ç”»éƒ¨é•·</td>
                    <td>2017-12-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-12">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">æˆ¦ç•¥çš„çµ„ç¹”é–‹ç™ºãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">çµŒå–¶æˆ¦ç•¥ã¨ã®é€£å‹•æ€§ã¨é•·æœŸçš„æˆé•·æ”¯æ´ãŒå·®åˆ¥åŒ–</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">çµŒå–¶å±¤ã§ã‚‚ã€Œæˆ¦ç•¥ãƒ„ãƒ¼ãƒ«ã€ã¨ã—ã¦èªè­˜ã•ã‚Œã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ä¼æ¥­æ–‡åŒ–ã®å¤‰é©ã«æˆåŠŸã—ãŸè¤‡æ•°äº‹ä¾‹ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å¤‰é©æœŸé–“ã®ä¸ç¢ºå®Ÿæ€§å¯¾å¿œãŒèª²é¡Œ</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(13)">
                    <td>æ‘ç”°ä½³å­ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ä¼ç”»éƒ¨</td>
                    <td>ä¼ç”»èª²é•·</td>
                    <td>2019-07-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-13">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">çµ„ç¹”è¨ºæ–­ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">è¨ºæ–­ç²¾åº¦ã¨å®Ÿè£…æ”¯æ´ã®é€£æº</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 5</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ä¼ç”»ãƒãƒ¼ãƒ å†…ã§ã‚‚ã€Œè¨ºæ–­ãƒ„ãƒ¼ãƒ«ã€ã§çµ±ä¸€</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã„ãã¤ã‹ã®ä¼æ¥­ãŒå¤‰ã‚ã£ãŸã®ã‚’è¦‹ã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">å®Ÿè£…å¾Œã®ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ãŒä¸ååˆ†</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(14)">
                    <td>æ—ç”°å¤ªä¸€ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ä¼ç”»éƒ¨</td>
                    <td>ä¼ç”»èª²é•·</td>
                    <td>2020-06-10</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-14">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ãƒ‘ãƒ«ã‚¹ã‚µãƒ¼ãƒ™ã‚¤ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒå£²ã‚Š</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒãƒ¼ãƒ å†…ã§ã‚‚æ„è¦‹ãŒåˆ†ã‹ã‚Œã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã„ãã¤ã‹æˆåŠŸäº‹ä¾‹ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ãƒ‡ãƒ¼ã‚¿ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œãŒæ¥­ç•ŒåŸºæº–ã‚’æº€ãŸã™ã‹ã©ã†ã‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(15)">
                    <td>å‰ç”°æµç¾ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ä¼ç”»éƒ¨</td>
                    <td>ä¼ç”»å“¡</td>
                    <td>2022-01-15</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-15">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ç¤¾å“¡ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ¸¬å®šãƒ„ãƒ¼ãƒ«</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚ˆãçŸ¥ã‚‰ãªã„éƒ¨åˆ†ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚ã„ã¾ã„ãªèª¬æ˜ãŒå¤šã„æ°—ãŒã™ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 1</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã¯ã£ãã‚Šã—ãŸæˆåŠŸäº‹ä¾‹ã‚’è¦‹ã¦ã„ãªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é¢ã§ã®å¿ƒé…ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 4</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(16)">
                    <td>å¡šæœ¬æ­¦å¿— <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ä¼ç”»éƒ¨</td>
                    <td>ä¼ç”»å“¡</td>
                    <td>2022-08-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-16">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ¸¬å®šãƒ„ãƒ¼ãƒ«</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚·ãƒ³ãƒ—ãƒ«ã§åˆ†ã‹ã‚Šã‚„ã™ã„ã¨æ€ã†</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚‚ã†å°‘ã—å®šç¾©ã‚’æƒãˆã‚‹å¿…è¦ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã„ãã¤ã‹è©±ã‚’èã„ã¦ã„ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã‚°ãƒ­ãƒ¼ãƒãƒ«å¯¾å¿œãŒã¾ã ä¸ååˆ†</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            
                <tr class="respondent-row" onclick="toggleRespondentDetails(17)">
                    <td>åŸç”°å„ªå­ <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>ä¼ç”»éƒ¨</td>
                    <td>ä¼ç”»å“¡</td>
                    <td>2023-02-01</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-17">
                    <td colspan="5">
                        <div class="respondent-answers">
                            
                                    <div class="answer-item">
                                        <div class="answer-question">Q1: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ</div>
                                        <div class="answer-text">äººæçµ„ç¹”ã‚µãƒ¼ãƒ™ã‚¤</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q2: å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">ã¯ã£ãã‚Šåˆ†ã‹ã‚‰ãªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 2</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q3: ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">èª¬æ˜ã«ã°ã‚‰ã¤ãã‚’æ„Ÿã˜ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 1</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q4: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">äº‹ä¾‹ã‚’ã‚ã¾ã‚ŠçŸ¥ã‚‰ãªã„</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 1</div>
                                    </div>
                                
                                    <div class="answer-item">
                                        <div class="answer-question">Q5: å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</div>
                                        <div class="answer-text">UI/UX ã«æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚‹</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: 3</div>
                                    </div>
                                
                        </div>
                    </td>
                </tr>
            </tbody>
                    </table>
                </div>
            </div>

            <!-- TAB: QUESTIONS -->
            <div id="questions" class="tab-content">
                <div class="section">
                    <div class="section-title">è¨­å•ç®¡ç†</div>
                    <div id="questionsList"></div>
                </div>
            </div>

            <!-- TAB: DISTRIBUTION -->
            <div id="distribution" class="tab-content">
                <div class="section">
                    <div class="section-title">é…å¸ƒURLç®¡ç†</div>
                    <div class="form-group">
                        <p style="color: #666; font-size: 14px; margin-bottom: 15px;">
                            ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€é…å¸ƒã—ãŸå›ç­”URLã®ä¸€è¦§ã¨å›ç­”çŠ¶æ³ã‚’ç¢ºèªã§ãã¾ã™ã€‚
                        </p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>é…å¸ƒæ—¥æ™‚</th>
                                <th>é…å¸ƒURL</th>
                                <th>çŠ¶æ…‹</th>
                                <th>å›ç­”æ•°</th>
                                <th>å‚™è€ƒ</th>
                                <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                            </tr>
                        </thead>
                        <tbody id="distributionTable">
                    <tr>
                        <td>2026/2/17 10:39:56</td>
                        <td><span class="link-display" style="margin: 0;">https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771292396385</span></td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td><input type="text" value="" onchange="updateLinkMemo(&#39;link-1771292396385&#39;, this.value)" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"></td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="copyLink(&#39;https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771292396385&#39;)">ã‚³ãƒ”ãƒ¼</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSurveyLink(&#39;link-1771292396385&#39;)" style="margin-left: 4px; background-color: #dc3545; color: white;">å‰Šé™¤</button>
                        </td>
                    </tr>
                
                    <tr>
                        <td>2026/2/17 12:21:11</td>
                        <td><span class="link-display" style="margin: 0;">https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298471974</span></td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td><input type="text" value="" onchange="updateLinkMemo(&#39;link-1771298471974&#39;, this.value)" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"></td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="copyLink(&#39;https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298471974&#39;)">ã‚³ãƒ”ãƒ¼</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSurveyLink(&#39;link-1771298471974&#39;)" style="margin-left: 4px; background-color: #dc3545; color: white;">å‰Šé™¤</button>
                        </td>
                    </tr>
                
                    <tr>
                        <td>2026/2/17 12:21:12</td>
                        <td><span class="link-display" style="margin: 0;">https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298472572</span></td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td><input type="text" value="" onchange="updateLinkMemo(&#39;link-1771298472572&#39;, this.value)" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"></td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="copyLink(&#39;https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298472572&#39;)">ã‚³ãƒ”ãƒ¼</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSurveyLink(&#39;link-1771298472572&#39;)" style="margin-left: 4px; background-color: #dc3545; color: white;">å‰Šé™¤</button>
                        </td>
                    </tr>
                
                    <tr>
                        <td>2026/2/17 12:21:12</td>
                        <td><span class="link-display" style="margin: 0;">https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298472973</span></td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td><input type="text" value="" onchange="updateLinkMemo(&#39;link-1771298472973&#39;, this.value)" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"></td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="copyLink(&#39;https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298472973&#39;)">ã‚³ãƒ”ãƒ¼</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSurveyLink(&#39;link-1771298472973&#39;)" style="margin-left: 4px; background-color: #dc3545; color: white;">å‰Šé™¤</button>
                        </td>
                    </tr>
                
                    <tr>
                        <td>2026/2/17 12:21:13</td>
                        <td><span class="link-display" style="margin: 0;">https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298473134</span></td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td><input type="text" value="" onchange="updateLinkMemo(&#39;link-1771298473134&#39;, this.value)" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"></td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="copyLink(&#39;https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298473134&#39;)">ã‚³ãƒ”ãƒ¼</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSurveyLink(&#39;link-1771298473134&#39;)" style="margin-left: 4px; background-color: #dc3545; color: white;">å‰Šé™¤</button>
                        </td>
                    </tr>
                
                    <tr>
                        <td>2026/2/17 12:21:13</td>
                        <td><span class="link-display" style="margin: 0;">https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298473284</span></td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td><input type="text" value="" onchange="updateLinkMemo(&#39;link-1771298473284&#39;, this.value)" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"></td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="copyLink(&#39;https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298473284&#39;)">ã‚³ãƒ”ãƒ¼</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSurveyLink(&#39;link-1771298473284&#39;)" style="margin-left: 4px; background-color: #dc3545; color: white;">å‰Šé™¤</button>
                        </td>
                    </tr>
                
                    <tr>
                        <td>2026/2/17 12:21:13</td>
                        <td><span class="link-display" style="margin: 0;">https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298473432</span></td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td><input type="text" value="" onchange="updateLinkMemo(&#39;link-1771298473432&#39;, this.value)" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"></td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="copyLink(&#39;https://charm-survey-production.up.railway.app/?mode=survey&amp;company=sample-corp&amp;linkId=link-1771298473432&#39;)">ã‚³ãƒ”ãƒ¼</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSurveyLink(&#39;link-1771298473432&#39;)" style="margin-left: 4px; background-color: #dc3545; color: white;">å‰Šé™¤</button>
                        </td>
                    </tr>
                </tbody>
                    </table>
                </div>

                <div class="section">
                    <div class="section-title">é…å¸ƒå±¥æ­´</div>
                    <table>
                        <thead>
                            <tr>
                                <th>URL ID</th>
                                <th>ç”Ÿæˆæ—¥æ™‚</th>
                                <th>é…å¸ƒçŠ¶æ…‹</th>
                                <th>å›ç­”è€…æ•°</th>
                                <th>å›ç­”ç‡</th>
                            </tr>
                        </thead>
                        <tbody id="historyTable">
                    <tr>
                        <td>link-1771292396385</td>
                        <td>2026/2/17 10:39:56</td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td>0.0%</td>
                    </tr>
                
                    <tr>
                        <td>link-1771298471974</td>
                        <td>2026/2/17 12:21:11</td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td>0.0%</td>
                    </tr>
                
                    <tr>
                        <td>link-1771298472572</td>
                        <td>2026/2/17 12:21:12</td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td>0.0%</td>
                    </tr>
                
                    <tr>
                        <td>link-1771298472973</td>
                        <td>2026/2/17 12:21:12</td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td>0.0%</td>
                    </tr>
                
                    <tr>
                        <td>link-1771298473134</td>
                        <td>2026/2/17 12:21:13</td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td>0.0%</td>
                    </tr>
                
                    <tr>
                        <td>link-1771298473284</td>
                        <td>2026/2/17 12:21:13</td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td>0.0%</td>
                    </tr>
                
                    <tr>
                        <td>link-1771298473432</td>
                        <td>2026/2/17 12:21:13</td>
                        <td><span class="status-badge status-active">é…å¸ƒä¸­</span></td>
                        <td>0å</td>
                        <td>0.0%</td>
                    </tr>
                </tbody>
                    </table>
                </div>
            </div>

            <!-- TAB: REPORT -->
            <div id="report" class="tab-content">
                <div class="slide-controls">
                    <button class="btn btn-secondary btn-sm" onclick="previousSlide()">â† å‰ã¸</button>
                    <span class="slide-info">
                        <span id="slideCounter">1</span> / <span id="slideTotal">1</span>
                    </span>
                    <button class="btn btn-secondary btn-sm" onclick="nextSlide()">æ¬¡ã¸ â†’</button>
                    <button class="btn btn-primary btn-sm" onclick="downloadReportPDF()" style="margin-left: auto; margin-right: 10px;">PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                    <button class="btn btn-success btn-sm" onclick="exportToGoogleSlides()" style="margin-left: 10px;">Googleã‚¹ãƒ©ã‚¤ãƒ‰ä½œæˆ</button>
                </div>

                <div class="slide-viewer">
                    <div class="slide-content" id="slideContent">
                        <p>ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¦ãã ã•ã„</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========================================
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹
        // ========================================
        let baseDomain = 'https://charm-survey-production.up.railway.app';
        let companies = [];
        let currentCompanyId = 'sample-corp';
        let isAdminMode = true;
        let surveyResponses = [];
        let currentQuestionIndex = 0;
        let currentSlide = 1;
        let allSlides = [];
        let surveyLinks = [];

        const surveyQuestions = [
            {
                id: 1,
                title: "å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ï¼äº‹æ¥­ã‚’ä¸€è¨€ã§è¡¨ã™ã¨ï¼Ÿ",
                textQuestion: "è¨˜è¿°ï¼š20ã€œ30æ–‡å­—",
                textPlaceholder: "",
                textMaxLength: 100,
                ratingQuestion: "ä¸Šè¨˜ã®å›ç­”ã¯ã©ã‚Œãã‚‰ã„è‡ªä¿¡ã‚’æŒã£ã¦è¨€ãˆã¾ã™ã‹ï¼Ÿ",
                ratingOptions: ["â‘ å…¨ãè¨€ãˆãªã„", "â‘¡ã‚ã¾ã‚Šè¨€ãˆãªã„", "â‘¢ã‚ã‚‹ç¨‹åº¦è¨€ãˆã‚‹", "â‘£ã‹ãªã‚Šè¨€ãˆã‚‹", "â‘¤æ˜ç¢ºã«è¨€ãˆã‚‹"]
            },
            {
                id: 2,
                title: "å½“ç¤¾ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ã€ä»–ç¤¾ã§ã¯ãªãå½“ç¤¾ãŒé¸ã°ã‚Œã‚‹ç†ç”±ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ",
                textQuestion: "è¨˜è¿°ï¼š300æ–‡å­—ä»¥å†…",
                textPlaceholder: "",
                textMaxLength: 300,
                ratingQuestion: "ä¸Šè¨˜ã®èª¬æ˜ã«ã©ã‚Œãã‚‰ã„è‡ªä¿¡ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ",
                ratingOptions: ["â‘ å…¨ãèª¬æ˜ã§ããªã„", "â‘¡ã‚ã¾ã‚Šèª¬æ˜ã§ããªã„", "â‘¢ã‚ã‚‹ç¨‹åº¦èª¬æ˜ã§ãã‚‹", "â‘£ã‹ãªã‚Šèª¬æ˜ã§ãã‚‹", "â‘¤å¼·ãè‡ªä¿¡ã‚’æŒã£ã¦èª¬æ˜ã§ãã‚‹"]
            },
            {
                id: 3,
                title: "ç¤¾å†…ã§å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®é­…åŠ›ã‚’èªã‚‹éš›ã€ä½¿ã‚ã‚Œã¦ã„ã‚‹è¨€è‘‰ã‚„è¡¨ç¾ã¯ã©ã®ç¨‹åº¦å…±é€šã—ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¾ã™ã‹ï¼Ÿ",
                textQuestion: "è¨˜è¿°ï¼š300æ–‡å­—ä»¥å†…ï¼ˆç†ç”±ï¼‰",
                textPlaceholder: "",
                textMaxLength: 300,
                ratingQuestion: "è¨€è‘‰ã‚„è¡¨ç¾ã®å…±é€šåº¦",
                ratingOptions: ["â‘ å…¨ãæƒã£ã¦ã„ãªã„", "â‘¡ã‚ã¾ã‚Šæƒã£ã¦ã„ãªã„", "â‘¢ã‚ã‚‹ç¨‹åº¦æƒã£ã¦ã„ã‚‹", "â‘£ã»ã¼åŒã˜è¨€è‘‰ã§èªã‚‰ã‚Œã¦ã„ã‚‹", "â‘¤éå¸¸ã«æƒã£ã¦ã„ã‚‹"]
            },
            {
                id: 4,
                title: "å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ãŒã€é¡§å®¢ã®æ„æ€æ±ºå®šã‚„è¡Œå‹•ã‚’å¤‰ãˆãŸäº‹ä¾‹ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã‹ï¼Ÿ",
                textQuestion: "è¨˜è¿°ï¼š300æ–‡å­—ä»¥å†…",
                textPlaceholder: "",
                textMaxLength: 300,
                ratingQuestion: "äº‹ä¾‹ã®å…·ä½“æ€§ãƒ»é‡",
                ratingOptions: ["â‘ å…¨ãæ€ã„æµ®ã‹ã°ãªã„", "â‘¡ã‚ã¾ã‚Šæ€ã„æµ®ã‹ã°ãªã„", "â‘¢ã‚ã‚‹ç¨‹åº¦æ€ã„æµ®ã‹ã¶", "â‘£è¤‡æ•°æ€ã„æµ®ã‹ã¶", "â‘¤å…·ä½“äº‹ä¾‹ã‚’ã‚‚ã¨ã«æ˜ç¢ºã«æ€ã„æµ®ã‹ã¶"]
            },
            {
                id: 5,
                title: "å½“ç¤¾ã‚µãƒ¼ãƒ“ã‚¹ã®ã€Œå‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ã€ã‚„ã€Œå¼±ã¿ãƒ»èª²é¡Œã€ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ",
                textQuestion: "è¨˜è¿°ï¼š300æ–‡å­—ä»¥å†…",
                textPlaceholder: "",
                textMaxLength: 300,
                ratingQuestion: "èª¬æ˜ã®æ˜ç¢ºã•",
                ratingOptions: ["â‘ å…¨ãèª¬æ˜ã§ããªã„", "â‘¡ã‚ã¾ã‚Šèª¬æ˜ã§ããªã„", "â‘¢å°‘ã—èª¬æ˜ã§ãã‚‹", "â‘£ã‚ã‚‹ç¨‹åº¦èª¬æ˜ã§ãã‚‹", "â‘¤æ˜ç¢ºã«èª¬æ˜ã§ãã‚‹"]
            }
        ];

        // ========================================
        // åˆæœŸåŒ–
        // ========================================
        function init() {
            const mode = new URLSearchParams(window.location.search).get('mode');
            if (mode === 'survey') {
                initializeSurveyMode();
            } else {
                initializeAdmin();
            }
        }

        function initializeAdmin() {
            initializeCompanies();
            // æœ€å¾Œã«é¸æŠã—ãŸä¼æ¥­ã‚’å¾©å…ƒã€ãªã‘ã‚Œã°sample-corpã‚’é¸æŠ
            const lastCompanyId = localStorage.getItem('lastSelectedCompanyId');
            const companyToSelect = lastCompanyId && companies.find(c => c.id === lastCompanyId) ? lastCompanyId : 'sample-corp';
            selectCompany(companyToSelect);
            addSampleData();
            loadSurveyLinks();
        }

        function initializeCompanies() {
            const stored = localStorage.getItem('companies');
            if (stored) {
                companies = JSON.parse(stored);
            } else {
                companies = [
                    { id: 'sample-corp', name: 'ã‚µãƒ³ãƒ—ãƒ«æ ªå¼ä¼šç¤¾' }
                ];
                localStorage.setItem('companies', JSON.stringify(companies));
            }
            renderCompanyList();
        }

        function renderCompanyList() {
            const list = document.getElementById('companyList');
            list.innerHTML = companies.map(c => `
                <div class="company-item ${c.id === currentCompanyId ? 'active' : ''}" style="display: flex; justify-content: space-between; align-items: center;">
                    <span onclick="selectCompany('${c.id}')" style="flex: 1; cursor: pointer;">${c.name}</span>
                    <button class="btn btn-sm" onclick="deleteCompany('${c.id}')" style="background-color: #dc3545; color: white; padding: 4px 8px; font-size: 11px; margin-left: 8px;">å‰Šé™¤</button>
                </div>
            `).join('');
        }

        function deleteCompany(companyId) {
            const companyToDelete = companies.find(c => c.id === companyId);
            const companyName = companyToDelete ? companyToDelete.name : companyId;
            if (confirm(`ã€Œ${companyName}ã€ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`)) {
                companies = companies.filter(c => c.id !== companyId);
                localStorage.setItem('companies', JSON.stringify(companies));
                if (currentCompanyId === companyId && companies.length > 0) {
                    selectCompany(companies[0].id);
                } else if (companies.length === 0) {
                    currentCompanyId = 'sample-corp';
                    companies = [{ id: 'sample-corp', name: 'ã‚µãƒ³ãƒ—ãƒ«æ ªå¼ä¼šç¤¾' }];
                    localStorage.setItem('companies', JSON.stringify(companies));
                    selectCompany('sample-corp');
                }
                renderCompanyList();
            }
        }

        function selectCompany(companyId) {
            currentCompanyId = companyId;
            localStorage.setItem('lastSelectedCompanyId', companyId);
            const company = companies.find(c => c.id === companyId);
            document.getElementById('companyName').textContent = company ? company.name : companyId;
            renderCompanyList();
            loadRespondents();
            loadSurveyLinks();
        }

        // ========================================
        // ========================================
        // ä¼æ¥­è¿½åŠ 
        // ========================================
        function showAddCompanyDialog() {
            const name = prompt('ä¼æ¥­åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            if (name && name.trim()) {
                const id = name.toLowerCase().replace(/\s+/g, '-');
                companies.push({ id, name: name.trim() });
                localStorage.setItem('companies', JSON.stringify(companies));
                renderCompanyList();
                selectCompany(id);
            }
        }

        // ========================================
        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        // ========================================
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');

            if (tabName === 'report') {
                displayReport();
            } else if (tabName === 'questions') {
                displayQuestions();
            } else if (tabName === 'distribution') {
                loadDistributionTable();
            }
        }

        // ========================================
        // å›ç­”è€…ç®¡ç†
        // ========================================
        function loadRespondents() {
            const stored = localStorage.getItem(`respondents_${currentCompanyId}`);
            surveyResponses = stored ? JSON.parse(stored) : [];
            document.getElementById('responseCount').textContent = `${surveyResponses.length}åã®å›ç­”è€…`;
            renderRespondentTable();
        }

        function renderRespondentTable() {
            const table = document.getElementById('respondentTable');
            table.innerHTML = surveyResponses.map((r, idx) => `
                <tr class="respondent-row" onclick="toggleRespondentDetails(${idx})">
                    <td>${r.name} <span class="respondent-toggle-icon">â–¼</span></td>
                    <td>${r.department}</td>
                    <td>${r.position}</td>
                    <td>${r.joinDate}</td>
                    <td><a href="javascript:void(0)" onclick="event.stopPropagation()">è¡¨ç¤º</a></td>
                </tr>
                <tr class="respondent-details" id="details-${idx}">
                    <td colspan="5">
                        <div class="respondent-answers">
                            ${r.answers.map((a, qIdx) => {
                                const q = surveyQuestions[qIdx];
                                return `
                                    <div class="answer-item">
                                        <div class="answer-question">Q${a.questionId}: ${q.title}</div>
                                        <div class="answer-text">${a.text}</div>
                                        <div class="answer-rating">ã‚¹ã‚³ã‚¢: ${a.rating}</div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function toggleRespondentDetails(idx) {
            const detailsRow = document.getElementById(`details-${idx}`);
            detailsRow.classList.toggle('open');
        }

        // ========================================
        // è³ªå•ç®¡ç†
        // ========================================
        function displayQuestions() {
            const list = document.getElementById('questionsList');
            list.innerHTML = surveyQuestions.map((q, idx) => `
                <div class="question-block" id="question-block-${idx}">
                    <div class="question-label">Q${q.id}: ${q.title}</div>
                    <div style="font-size: 12px; color: #999; margin: 8px 0;">
                        ${q.textQuestion} | ${q.ratingQuestion}
                    </div>
                    <button class="btn btn-primary btn-sm" onclick="startEditQuestion(${idx})">ç·¨é›†</button>
                </div>
            `).join('');
        }

        function startEditQuestion(idx) {
            const q = surveyQuestions[idx];
            const block = document.getElementById(`question-block-${idx}`);
            const optionsHtml = q.ratingOptions.map((opt, i) => `
                <input type="text" id="edit-opt-${idx}-${i}" value="${opt}" style="width: 100%; padding: 8px; margin-bottom: 6px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; font-size: 12px;">
            `).join('');
            block.innerHTML = `
                <div class="form-group">
                    <label>è³ªå•ãƒ†ã‚­ã‚¹ãƒˆ</label>
                    <textarea id="edit-q-${idx}" class="inline-edit-textarea">${q.title}</textarea>
                </div>
                <div class="form-group">
                    <label>é¸æŠè‚¢</label>
                    ${optionsHtml}
                </div>
                <div class="inline-edit-buttons">
                    <button class="btn btn-success btn-sm" onclick="saveEditQuestion(${idx})">ä¿å­˜</button>
                    <button class="btn btn-secondary btn-sm" onclick="cancelEditQuestion(${idx})">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                </div>
            `;
        }

        function saveEditQuestion(idx) {
            const newTitle = document.getElementById(`edit-q-${idx}`).value.trim();
            const q = surveyQuestions[idx];

            if (!newTitle) {
                alert('è³ªå•ãƒ†ã‚­ã‚¹ãƒˆã¯å¿…é ˆã§ã™');
                return;
            }

            surveyQuestions[idx].title = newTitle;

            // Update rating options
            const newOptions = [];
            for (let i = 0; i < q.ratingOptions.length; i++) {
                const optValue = document.getElementById(`edit-opt-${idx}-${i}`).value.trim();
                newOptions.push(optValue || `é¸æŠè‚¢${i + 1}`);
            }
            surveyQuestions[idx].ratingOptions = newOptions;

            localStorage.setItem('surveyQuestions', JSON.stringify(surveyQuestions));
            displayQuestions();
            alert('è³ªå•ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
        }

        function cancelEditQuestion(idx) {
            displayQuestions();
        }

        // ========================================
        // é…å¸ƒç®¡ç†
        // ========================================
        function loadSurveyLinks() {
            const stored = localStorage.getItem(`surveyLinks_${currentCompanyId}`);
            surveyLinks = stored ? JSON.parse(stored) : [];
            loadDistributionTable();
        }

        function saveSurveyLinks() {
            localStorage.setItem(`surveyLinks_${currentCompanyId}`, JSON.stringify(surveyLinks));
        }

        function loadDistributionTable() {
            if (surveyLinks.length === 0) {
                document.getElementById('distributionTable').innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; color: #999;">
                            URLã‚’ç”Ÿæˆã—ã¦ã‹ã‚‰é…å¸ƒã—ã¦ãã ã•ã„
                        </td>
                    </tr>
                `;
                document.getElementById('historyTable').innerHTML = '';
                return;
            }

            const tableHtml = surveyLinks.map((link, idx) => {
                const respondentCount = surveyResponses.filter(r => r.surveyLinkId === link.id).length;
                const memo = link.memo || '';
                return `
                    <tr>
                        <td>${link.createdAt}</td>
                        <td><span class="link-display" style="margin: 0;">${link.url}</span></td>
                        <td><span class="status-badge status-${link.status}">${link.status === 'active' ? 'é…å¸ƒä¸­' : 'ä¿ç•™ä¸­'}</span></td>
                        <td>${respondentCount}å</td>
                        <td><input type="text" value="${memo}" onchange="updateLinkMemo('${link.id}', this.value)" style="width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;"></td>
                        <td>
                            <button class="btn btn-secondary btn-sm" onclick="copyLink('${link.url}')">ã‚³ãƒ”ãƒ¼</button>
                            <button class="btn btn-danger btn-sm" onclick="deleteSurveyLink('${link.id}')" style="margin-left: 4px; background-color: #dc3545; color: white;">å‰Šé™¤</button>
                        </td>
                    </tr>
                `;
            }).join('');

            document.getElementById('distributionTable').innerHTML = tableHtml;

            const historyHtml = surveyLinks.map((link, idx) => {
                const respondentCount = surveyResponses.filter(r => r.surveyLinkId === link.id).length;
                const responseRate = surveyResponses.length > 0 ? ((respondentCount / surveyResponses.length) * 100).toFixed(1) : '0';
                return `
                    <tr>
                        <td>${link.id}</td>
                        <td>${link.createdAt}</td>
                        <td><span class="status-badge status-${link.status}">${link.status === 'active' ? 'é…å¸ƒä¸­' : 'ä¿ç•™ä¸­'}</span></td>
                        <td>${respondentCount}å</td>
                        <td>${responseRate}%</td>
                    </tr>
                `;
            }).join('');

            document.getElementById('historyTable').innerHTML = historyHtml;
        }

        function copyLink(url) {
            navigator.clipboard.writeText(url).then(() => {
                alert('ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
            });
        }

        function updateLinkMemo(linkId, memoText) {
            const link = surveyLinks.find(l => l.id === linkId);
            if (link) {
                link.memo = memoText;
                saveSurveyLinks();
            }
        }

        function deleteSurveyLink(linkId) {
            const link = surveyLinks.find(l => l.id === linkId);
            if (link && confirm(`é…å¸ƒãƒªãƒ³ã‚¯ã€Œ${link.createdAt}ã€ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`)) {
                surveyLinks = surveyLinks.filter(l => l.id !== linkId);
                saveSurveyLinks();
                loadDistributionTable();
                alert('é…å¸ƒãƒªãƒ³ã‚¯ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
            }
        }

        // ========================================
        // ã‚µãƒ¼ãƒ™ã‚¤ãƒªãƒ³ã‚¯ï¼†QRã‚³ãƒ¼ãƒ‰
        // ========================================
        function generateSurveyLink() {
            const linkId = 'link-' + Date.now();
            const link = `${baseDomain}/?mode=survey&company=${currentCompanyId}&linkId=${linkId}`;

            // Save link info
            surveyLinks.push({
                id: linkId,
                url: link,
                createdAt: new Date().toLocaleString('ja-JP'),
                status: 'active'
            });
            saveSurveyLinks();

            document.getElementById('surveyLink').textContent = link;

            loadDistributionTable();
        }

        function copySurveyLink() {
            const link = document.getElementById('surveyLink').textContent;
            navigator.clipboard.writeText(link).then(() => {
                alert('ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
            });
        }

        function previewSurvey() {
            const link = document.getElementById('surveyLink').textContent;
            if (link && !link.includes('ãƒªãƒ³ã‚¯ã‚’ç”Ÿæˆ')) {
                window.open(link, '_blank');
            }
        }

        // ========================================
        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆ18äººï¼‰
        // ========================================
        function addSampleData() {
            const sampleRespondents = [
                // å–¶æ¥­éƒ¨ï¼ˆ6äººï¼‰
                {name: 'ç”°ä¸­å¤ªéƒ', department: 'å–¶æ¥­éƒ¨', position: 'å–¶æ¥­èª²é•·', joinDate: '2020-01-15', surveyLinkId: 'link-1', answers: [{questionId: 1, text: 'ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ™ã‚¤ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ', rating: '5'}, {questionId: 2, text: 'é¡§å®¢ãƒ‡ãƒ¼ã‚¿åˆ†æã®ç²¾åº¦ãŒä»–ç¤¾æ¯”è¼ƒã§å„ªã‚Œã¦ã„ã‚‹', rating: '4'}, {questionId: 3, text: 'ç¤¾å†…ã§ã‚‚ã€Œãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«ã€ã¨ã‚ˆãè¨€ã‚ã‚Œã¦ã„ã‚‹', rating: '5'}, {questionId: 4, text: 'é‡‘èæ©Ÿé–¢ãŒãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³çµŒå–¶ã«è»¢æ›ã—ãŸäº‹ä¾‹ãŒã‚ã‚‹', rating: '4'}, {questionId: 5, text: 'å¤§ä¼æ¥­å‘ã‘ã«ã¯ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¿…è¦ãªå ´åˆãŒã‚ã‚‹', rating: '3'}]},
                {name: 'å±±ç”°èŠ±å­', department: 'å–¶æ¥­éƒ¨', position: 'å–¶æ¥­éƒ¨é•·', joinDate: '2019-03-20', surveyLinkId: 'link-1', answers: [{questionId: 1, text: 'ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«', rating: '4'}, {questionId: 2, text: 'ä½¿ã„ã‚„ã™ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨å°å…¥ã®å®¹æ˜“ã•ãŒå·®åˆ¥åŒ–è¦å› ', rating: '5'}, {questionId: 3, text: 'ã€Œç°¡å˜ã«ä½¿ãˆã‚‹ã€ã¨ã„ã†è©•åˆ¤ãŒå¤šã„', rating: '4'}, {questionId: 4, text: 'è¤‡æ•°ã®é¡§å®¢ãŒå£²ä¸Šæ”¹å–„ã«ç¹‹ãŒã£ãŸ', rating: '5'}, {questionId: 5, text: 'å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¸ã®å¯¾å¿œã«èª²é¡ŒãŒã‚ã‚‹', rating: '2'}]},
                {name: 'ä½è—¤æ¬¡éƒ', department: 'å–¶æ¥­éƒ¨', position: 'å–¶æ¥­ä¸»ä»»', joinDate: '2021-07-10', surveyLinkId: 'link-1', answers: [{questionId: 1, text: 'ã‚µãƒ¼ãƒ™ã‚¤ãƒ„ãƒ¼ãƒ«', rating: '3'}, {questionId: 2, text: 'å°å…¥ã«æ‰‹é–“ãŒã‹ã‹ã‚‹ãŒã€å°å…¥å¾Œã®åŠ¹æœãŒå¤§ãã„', rating: '3'}, {questionId: 3, text: 'äººã«ã‚ˆã£ã¦è¨€ã„æ–¹ãŒã°ã‚‰ã°ã‚‰ãªæ°—ãŒã™ã‚‹', rating: '2'}, {questionId: 4, text: 'ã„ãã¤ã‹äº‹ä¾‹ã¯çŸ¥ã£ã¦ã„ã‚‹ãŒè©³ã—ããªã„', rating: '3'}, {questionId: 5, text: 'ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒ“ã‚¸ãƒã‚¹ã«ã¯é«˜ã„ã®ã§ã¯ãªã„ã‹', rating: '4'}]},
                {name: 'éˆ´æœ¨å¤ªéƒ', department: 'å–¶æ¥­éƒ¨', position: 'å–¶æ¥­ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ', joinDate: '2022-04-01', surveyLinkId: 'link-1', answers: [{questionId: 1, text: 'çµ„ç¹”ã®ã‚µãƒ¼ãƒ™ã‚¤ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³', rating: '2'}, {questionId: 2, text: 'ã‚ˆãåˆ†ã‹ã‚‰ãªã„éƒ¨åˆ†ãŒå¤šã„', rating: '2'}, {questionId: 3, text: 'ã‚ã¾ã‚Šå…±é€šã®è¨€è‘‰ã‚’ä½¿ã£ã¦ã„ãªã„ã‚ˆã†ãªæ°—ãŒã™ã‚‹', rating: '1'}, {questionId: 4, text: 'å…·ä½“çš„ãªäº‹ä¾‹ã‚’çŸ¥ã‚‰ãªã„', rating: '1'}, {questionId: 5, text: 'å¼±ã¿ã«ã¤ã„ã¦è€ƒãˆãŸã“ã¨ãŒãªã„', rating: '2'}]},
                {name: 'ä¼Šè—¤å¥å¤ª', department: 'å–¶æ¥­éƒ¨', position: 'å–¶æ¥­', joinDate: '2022-06-15', surveyLinkId: 'link-1', answers: [{questionId: 1, text: 'ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ™ã‚¤ã‚·ã‚¹ãƒ†ãƒ ', rating: '4'}, {questionId: 2, text: 'å®Ÿè£…ã®é€Ÿã•ã¨è‰¯ã„ã‚µãƒãƒ¼ãƒˆ', rating: '4'}, {questionId: 3, text: 'å‰²ã¨ã€Œé€Ÿã„ã€ã¨ã„ã†è¨€è‘‰ãŒã‚ˆãå‡ºã¦ã„ã‚‹', rating: '3'}, {questionId: 4, text: 'ã„ãã¤ã‹è‰¯ã„äº‹ä¾‹ãŒã‚ã‚‹', rating: '4'}, {questionId: 5, text: 'ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒã‚„ã‚„é™å®šçš„', rating: '3'}]},
                {name: 'æ°´é‡ç¾å’²', department: 'å–¶æ¥­éƒ¨', position: 'å–¶æ¥­', joinDate: '2023-01-10', surveyLinkId: 'link-1', answers: [{questionId: 1, text: 'ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ', rating: '3'}, {questionId: 2, text: 'çµ±åˆå‹ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒå¼·ã¿', rating: '3'}, {questionId: 3, text: 'å®šç¾©ãŒã‚„ã‚„æ›–æ˜§', rating: '2'}, {questionId: 4, text: 'å¤‰åŒ–ã‚’è¦‹ãŸé¡§å®¢ãŒã„ã‚‹ã¯ãš', rating: '3'}, {questionId: 5, text: 'UIã®æ”¹å–„ä½™åœ°ãŒã‚ã‚‹', rating: '3'}]},

                // ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨ï¼ˆ6äººï¼‰
                {name: 'æ£®ç”°å½©å­', department: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', position: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨é•·', joinDate: '2018-05-10', surveyLinkId: 'link-2', answers: [{questionId: 1, text: 'ã‚ªãƒ¼ã‚¬ãƒŠã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³æœ€é©åŒ–ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ', rating: '5'}, {questionId: 2, text: 'AIãƒ™ãƒ¼ã‚¹ã®åˆ†æã¨çµ„ç¹”é–‹ç™ºã®èåˆãŒå·®åˆ¥åŒ–', rating: '5'}, {questionId: 3, text: 'ç¤¾å†…ã§ã¯ã€Œçµ„ç¹”æ”¹é©ãƒ„ãƒ¼ãƒ«ã€ã¨çµ±ä¸€ã•ã‚Œã¦ã„ã‚‹', rating: '5'}, {questionId: 4, text: 'é¡§å®¢ã®çµ„ç¹”æ”¹é©ã«å¤§ããè²¢çŒ®ã—ãŸè¤‡æ•°äº‹ä¾‹ãŒã‚ã‚‹', rating: '5'}, {questionId: 5, text: 'å°å…¥å‰å¾Œã®æ–‡åŒ–çš„æŠµæŠ—ã¸ã®å¯¾å¿œãŒèª²é¡Œ', rating: '2'}]},
                {name: 'ä¸­æ‘ã‚†ã‚Š', department: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', position: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°èª²é•·', joinDate: '2019-08-01', surveyLinkId: 'link-2', answers: [{questionId: 1, text: 'çµ„ç¹”æ”¹å–„ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³', rating: '4'}, {questionId: 2, text: 'ãƒ›ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ç¶™ç¶šçš„ã‚µãƒãƒ¼ãƒˆ', rating: '5'}, {questionId: 3, text: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒ å†…ã§ã‚‚ã€Œæ”¹å–„ãƒ„ãƒ¼ãƒ«ã€ã§çµ±ä¸€', rating: '4'}, {questionId: 4, text: 'å¤§æ‰‹ä¼æ¥­ã‹ã‚‰ã®ãƒã‚¸ãƒ†ã‚£ãƒ–ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒå¤šã„', rating: '5'}, {questionId: 5, text: 'å°è¦æ¨¡çµ„ç¹”ã§ã® ROI ãŒä¸æ˜ç­ãªå ´åˆãŒã‚ã‚‹', rating: '1'}]},
                {name: 'ç”°æ‰€æ‹“ä¹Ÿ', department: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', position: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°èª²é•·', joinDate: '2020-02-15', surveyLinkId: 'link-2', answers: [{questionId: 1, text: 'ã‚¨ãƒ³ãƒ—ãƒ­ã‚¤ãƒ¤ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ', rating: '4'}, {questionId: 2, text: 'EX é‡è¦–ã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¨ç¶™ç¶šã‚µãƒãƒ¼ãƒˆ', rating: '4'}, {questionId: 3, text: 'ãƒãƒ¼ãƒ å†…ã§ã‚‚æ„è­˜ã¯é«˜ã„ãŒè¨€è‘‰ã®å®šç¾©ã¯æ›–æ˜§', rating: '3'}, {questionId: 4, text: 'ã„ãã¤ã‹æˆåŠŸäº‹ä¾‹ã‚’è¦‹ã¦ã„ã‚‹', rating: '4'}, {questionId: 5, text: 'ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹æ™‚ã®åœ°åŸŸå·®ã¸ã®å¯¾å¿œ', rating: '2'}]},
                {name: 'å²¡æœ¬ç¾å„ª', department: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', position: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ', joinDate: '2021-09-01', surveyLinkId: 'link-2', answers: [{questionId: 1, text: 'äººäº‹å‘ã‘ã‚µãƒ¼ãƒ™ã‚¤ãƒ„ãƒ¼ãƒ«', rating: '3'}, {questionId: 2, text: 'å®‰ä¾¡ã•ã¨å°å…¥ã®ç°¡å˜ã•', rating: '3'}, {questionId: 3, text: 'ã‚ˆãåˆ†ã‹ã‚‰ãªã„ã¨ã„ã†äººã‚‚å¤šã„', rating: '2'}, {questionId: 4, text: 'èã„ãŸã“ã¨ãŒã‚ã‚‹ã‚ˆã†ãªæ°—ãŒã™ã‚‹ãŒè©³ã—ããªã„', rating: '2'}, {questionId: 5, text: 'ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—ãŒååˆ†ã§ãªã„å¯èƒ½æ€§', rating: '3'}]},
                {name: 'é«˜æ©‹å¥ä¸€', department: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', position: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°', joinDate: '2022-04-01', surveyLinkId: 'link-2', answers: [{questionId: 1, text: 'ã‚µãƒ¼ãƒ™ã‚¤ãƒ»åˆ†æãƒ„ãƒ¼ãƒ«', rating: '2'}, {questionId: 2, text: 'ã¶ã£ã¡ã‚ƒã‘ã‚ˆãåˆ†ã‹ã‚‰ãªã„', rating: '2'}, {questionId: 3, text: 'ãƒãƒ©ãƒãƒ©', rating: '1'}, {questionId: 4, text: 'èã„ãŸã“ã¨ãªã„', rating: '1'}, {questionId: 5, text: 'ã»ã¼å…¨éƒ¨', rating: '5'}]},
                {name: 'å‚å£æœ‰å¸Œ', department: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', position: 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°', joinDate: '2023-03-01', surveyLinkId: 'link-2', answers: [{questionId: 1, text: 'ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³', rating: '3'}, {questionId: 2, text: 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½ãŒåˆ†ã‹ã‚Šã‚„ã™ã„', rating: '3'}, {questionId: 3, text: 'å®šç¾©ãŒæƒã„ãã£ã¦ã„ãªã„éƒ¨åˆ†ãŒã‚ã‚‹', rating: '2'}, {questionId: 4, text: 'ã„ãã¤ã‹å°å…¥äº‹ä¾‹ã‚’èã„ã¦ã„ã‚‹', rating: '3'}, {questionId: 5, text: 'ãƒ—ãƒªã‚»ãƒƒãƒˆãƒ¬ãƒãƒ¼ãƒˆãŒé™å®šçš„', rating: '2'}]},

                // ä¼ç”»éƒ¨ï¼ˆ6äººï¼‰
                {name: 'éˆ´æœ¨èŠ±å­', department: 'ä¼ç”»éƒ¨', position: 'ä¼ç”»éƒ¨é•·', joinDate: '2017-12-01', surveyLinkId: 'link-3', answers: [{questionId: 1, text: 'æˆ¦ç•¥çš„çµ„ç¹”é–‹ç™ºãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ', rating: '5'}, {questionId: 2, text: 'çµŒå–¶æˆ¦ç•¥ã¨ã®é€£å‹•æ€§ã¨é•·æœŸçš„æˆé•·æ”¯æ´ãŒå·®åˆ¥åŒ–', rating: '4'}, {questionId: 3, text: 'çµŒå–¶å±¤ã§ã‚‚ã€Œæˆ¦ç•¥ãƒ„ãƒ¼ãƒ«ã€ã¨ã—ã¦èªè­˜ã•ã‚Œã¦ã„ã‚‹', rating: '5'}, {questionId: 4, text: 'ä¼æ¥­æ–‡åŒ–ã®å¤‰é©ã«æˆåŠŸã—ãŸè¤‡æ•°äº‹ä¾‹ãŒã‚ã‚‹', rating: '4'}, {questionId: 5, text: 'å¤‰é©æœŸé–“ã®ä¸ç¢ºå®Ÿæ€§å¯¾å¿œãŒèª²é¡Œ', rating: '3'}]},
                {name: 'æ‘ç”°ä½³å­', department: 'ä¼ç”»éƒ¨', position: 'ä¼ç”»èª²é•·', joinDate: '2019-07-01', surveyLinkId: 'link-3', answers: [{questionId: 1, text: 'çµ„ç¹”è¨ºæ–­ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³', rating: '4'}, {questionId: 2, text: 'è¨ºæ–­ç²¾åº¦ã¨å®Ÿè£…æ”¯æ´ã®é€£æº', rating: '5'}, {questionId: 3, text: 'ä¼ç”»ãƒãƒ¼ãƒ å†…ã§ã‚‚ã€Œè¨ºæ–­ãƒ„ãƒ¼ãƒ«ã€ã§çµ±ä¸€', rating: '4'}, {questionId: 4, text: 'ã„ãã¤ã‹ã®ä¼æ¥­ãŒå¤‰ã‚ã£ãŸã®ã‚’è¦‹ã¦ã„ã‚‹', rating: '4'}, {questionId: 5, text: 'å®Ÿè£…å¾Œã®ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ãŒä¸ååˆ†', rating: '2'}]},
                {name: 'æ—ç”°å¤ªä¸€', department: 'ä¼ç”»éƒ¨', position: 'ä¼ç”»èª²é•·', joinDate: '2020-06-10', surveyLinkId: 'link-3', answers: [{questionId: 1, text: 'ãƒ‘ãƒ«ã‚¹ã‚µãƒ¼ãƒ™ã‚¤ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ', rating: '3'}, {questionId: 2, text: 'ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒå£²ã‚Š', rating: '3'}, {questionId: 3, text: 'ãƒãƒ¼ãƒ å†…ã§ã‚‚æ„è¦‹ãŒåˆ†ã‹ã‚Œã¦ã„ã‚‹', rating: '2'}, {questionId: 4, text: 'ã„ãã¤ã‹æˆåŠŸäº‹ä¾‹ãŒã‚ã‚‹', rating: '3'}, {questionId: 5, text: 'ãƒ‡ãƒ¼ã‚¿ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œãŒæ¥­ç•ŒåŸºæº–ã‚’æº€ãŸã™ã‹ã©ã†ã‹', rating: '3'}]},
                {name: 'å‰ç”°æµç¾', department: 'ä¼ç”»éƒ¨', position: 'ä¼ç”»å“¡', joinDate: '2022-01-15', surveyLinkId: 'link-3', answers: [{questionId: 1, text: 'ç¤¾å“¡ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ¸¬å®šãƒ„ãƒ¼ãƒ«', rating: '2'}, {questionId: 2, text: 'ã‚ˆãçŸ¥ã‚‰ãªã„éƒ¨åˆ†ãŒã‚ã‚‹', rating: '2'}, {questionId: 3, text: 'ã‚ã„ã¾ã„ãªèª¬æ˜ãŒå¤šã„æ°—ãŒã™ã‚‹', rating: '1'}, {questionId: 4, text: 'ã¯ã£ãã‚Šã—ãŸæˆåŠŸäº‹ä¾‹ã‚’è¦‹ã¦ã„ãªã„', rating: '2'}, {questionId: 5, text: 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é¢ã§ã®å¿ƒé…ãŒã‚ã‚‹', rating: '4'}]},
                {name: 'å¡šæœ¬æ­¦å¿—', department: 'ä¼ç”»éƒ¨', position: 'ä¼ç”»å“¡', joinDate: '2022-08-01', surveyLinkId: 'link-3', answers: [{questionId: 1, text: 'ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆæ¸¬å®šãƒ„ãƒ¼ãƒ«', rating: '3'}, {questionId: 2, text: 'ã‚·ãƒ³ãƒ—ãƒ«ã§åˆ†ã‹ã‚Šã‚„ã™ã„ã¨æ€ã†', rating: '3'}, {questionId: 3, text: 'ã‚‚ã†å°‘ã—å®šç¾©ã‚’æƒãˆã‚‹å¿…è¦ãŒã‚ã‚‹', rating: '2'}, {questionId: 4, text: 'ã„ãã¤ã‹è©±ã‚’èã„ã¦ã„ã‚‹', rating: '3'}, {questionId: 5, text: 'ã‚°ãƒ­ãƒ¼ãƒãƒ«å¯¾å¿œãŒã¾ã ä¸ååˆ†', rating: '3'}]},
                {name: 'åŸç”°å„ªå­', department: 'ä¼ç”»éƒ¨', position: 'ä¼ç”»å“¡', joinDate: '2023-02-01', surveyLinkId: 'link-3', answers: [{questionId: 1, text: 'äººæçµ„ç¹”ã‚µãƒ¼ãƒ™ã‚¤', rating: '2'}, {questionId: 2, text: 'ã¯ã£ãã‚Šåˆ†ã‹ã‚‰ãªã„', rating: '2'}, {questionId: 3, text: 'èª¬æ˜ã«ã°ã‚‰ã¤ãã‚’æ„Ÿã˜ã‚‹', rating: '1'}, {questionId: 4, text: 'äº‹ä¾‹ã‚’ã‚ã¾ã‚ŠçŸ¥ã‚‰ãªã„', rating: '1'}, {questionId: 5, text: 'UI/UX ã«æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚‹', rating: '3'}]}
            ];

            const existing = localStorage.getItem(`respondents_${currentCompanyId}`);
            if (!existing) {
                localStorage.setItem(`respondents_${currentCompanyId}`, JSON.stringify(sampleRespondents));
                surveyResponses = sampleRespondents;
                document.getElementById('responseCount').textContent = `${surveyResponses.length}åã®å›ç­”è€…`;
                renderRespondentTable();
            }
        }

        // ========================================
        // ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼ˆ13ã‚¹ãƒ©ã‚¤ãƒ‰ï¼‰
        // ========================================
        function displayReport() {
            const respondents = JSON.parse(localStorage.getItem(`respondents_${currentCompanyId}`)) || [];
            if (respondents.length === 0) {
                document.getElementById('slideContent').innerHTML = '<p style="color: #999;">å›ç­”ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                return;
            }

            allSlides = generateReportSlides(respondents);
            currentSlide = 1;
            document.getElementById('slideTotal').textContent = allSlides.length;
            renderSlide(allSlides[0]);
        }

        function generateReportSlides(respondents) {
            const slides = [];
            const companyObj = companies.find(c => c.id === currentCompanyId);
            const company = companyObj ? companyObj.name : currentCompanyId;

            // ã‚¹ãƒ©ã‚¤ãƒ‰1: ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼
            slides.push({
                title: 'ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼',
                html: generateExecutiveSummary(respondents, company)
            });

            // ã‚¹ãƒ©ã‚¤ãƒ‰2: å…¨ä½“å‚¾å‘åˆ†æ
            slides.push({
                title: 'å…¨ä½“å‚¾å‘åˆ†æ',
                html: generateOverallTrends(respondents)
            });

            // ã‚¹ãƒ©ã‚¤ãƒ‰3-7: å„è¨­å•è©³ç´°åˆ†æï¼ˆQ1-Q5ï¼‰
            for (let i = 0; i < 5; i++) {
                slides.push({
                    title: `Q${i+1}è©³ç´°åˆ†æ: ${surveyQuestions[i].title.substring(0, 30)}...`,
                    html: generateQuestionDetail(respondents, i)
                });
            }

            // ã‚¹ãƒ©ã‚¤ãƒ‰8: éƒ¨ç½²åˆ¥æ¯”è¼ƒ
            slides.push({
                title: 'éƒ¨ç½²åˆ¥æ¯”è¼ƒåˆ†æ',
                html: generateDepartmentComparison(respondents)
            });

            // ã‚¹ãƒ©ã‚¤ãƒ‰9: 4è±¡é™ãƒãƒƒãƒ—
            slides.push({
                title: '4è±¡é™ãƒãƒƒãƒ—åˆ†æ',
                html: generateQuadrantMap(respondents)
            });

            // ã‚¹ãƒ©ã‚¤ãƒ‰10: Box Plotåˆ†æ
            slides.push({
                title: 'Box Plotåˆ†æï¼ˆã°ã‚‰ã¤ãåˆ†æï¼‰',
                html: generateBoxPlotAnalysis(respondents)
            });

            // ã‚¹ãƒ©ã‚¤ãƒ‰11: No Decisionåˆ†æ
            slides.push({
                title: 'No Decisionåˆ†æ',
                html: generateNoDecisionAnalysis(respondents)
            });

            // ã‚¹ãƒ©ã‚¤ãƒ‰12: æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³
            slides.push({
                title: 'æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³',
                html: generateActionPlan(respondents)
            });

            // ã‚¹ãƒ©ã‚¤ãƒ‰13: å€‹äººåä»˜ãå›ç­”ä¸€è¦§
            slides.push({
                title: 'å€‹äººåˆ¥å›ç­”è©³ç´°',
                html: generateRespondentDetails(respondents)
            });

            return slides;
        }

        function generateExecutiveSummary(respondents, company) {
            const avgScores = calculateAverageScores(respondents);
            const variance = calculateVariance(respondents);

            let insight = 'çµ„ç¹”å†…ã«ã‚ºãƒ¬ãŒè¦‹ã‚‰ã‚Œã¾ã™ï¼š';
            const highVar = variance.filter(v => v.variance > 1.5).map(v => `Q${v.qId}`);
            if (highVar.length > 0) {
                insight += `\n${highVar.join(', ')} ã§å›ç­”ãŒåˆ†æ•£ã€‚å®šç¾©ã‚„ç†è§£ãŒçµ±ä¸€ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚`;
            }

            const overallAvg = avgScores.length > 0 ? (avgScores.reduce((sum, s) => sum + s.avg, 0) / avgScores.length) : 0;
            const scoreColor = overallAvg >= 4 ? '#28a745' : overallAvg >= 3 ? '#ffc107' : '#dc3545';

            return `
                <div class="slide-section" style="background: linear-gradient(135deg, #1f4788 0%, #2d5aa4 100%); color: white; padding: 30px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 12px; opacity: 0.9; margin-bottom: 8px;">ä¼æ¥­å</div>
                            <div style="font-size: 18px; font-weight: 700;">${company}</div>
                        </div>
                        <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); border-right: 1px solid rgba(255,255,255,0.3);">
                            <div style="font-size: 12px; opacity: 0.9; margin-bottom: 8px;">å›ç­”è€…æ•°</div>
                            <div style="font-size: 18px; font-weight: 700;">${respondents.length}å</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 12px; opacity: 0.9; margin-bottom: 8px;">èª¿æŸ»æ—¥</div>
                            <div style="font-size: 18px; font-weight: 700;">${new Date().toLocaleDateString('ja-JP')}</div>
                        </div>
                    </div>
                </div>

                <div class="slide-section">
                    <div class="slide-subtitle" style="margin-bottom: 15px;">å…¨ä½“ã‚¹ã‚³ã‚¢åˆ†æ</div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <div style="font-size: 14px; color: #666; margin-bottom: 5px;">ç·åˆè©•ä¾¡ã‚¹ã‚³ã‚¢</div>
                            <div style="font-size: 36px; font-weight: 700; color: ${scoreColor};">${overallAvg.toFixed(1)} / 5.0</div>
                        </div>
                        ${avgScores.map(s => {
                            const barColor = s.avg >= 4 ? '#28a745' : s.avg >= 3 ? '#ffc107' : '#dc3545';
                            const barWidth = (s.avg / 5) * 100;
                            return `
                                <div style="margin-bottom: 12px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                        <span style="font-weight: 600; font-size: 13px;">Q${s.qId}</span>
                                        <span style="font-weight: 700; color: ${barColor};">${s.avg.toFixed(1)}</span>
                                    </div>
                                    <div style="background: #e0e0e0; height: 12px; border-radius: 6px; overflow: hidden;">
                                        <div style="background: ${barColor}; height: 100%; width: ${barWidth}%; border-radius: 6px;"></div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>

                <div class="insight-box" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; border-radius: 4px;">
                    <div class="insight-title" style="color: #856404; margin-bottom: 8px;">æˆ¦ç•¥ã‚ºãƒ¬ã®è¨ºæ–­</div>
                    <div class="insight-text" style="color: #856404; font-size: 13px; line-height: 1.6;">${insight}</div>
                </div>
            `;
        }

        function generateOverallTrends(respondents) {
            const avgScores = calculateAverageScores(respondents);
            const distrib = calculateDistribution(respondents);

            return `
                <div class="slide-section">
                    <div class="slide-subtitle">Qåˆ¥ã‚¹ã‚³ã‚¢æ¯”è¼ƒ</div>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                        ${avgScores.map(s => {
                            const v = calculateVariance(respondents).find(v => v.qId === s.qId);
                            const d = distrib[s.qId];
                            const barColor = s.avg >= 4 ? '#28a745' : s.avg >= 3 ? '#ffc107' : '#dc3545';
                            const barWidth = (s.avg / 5) * 100;
                            return `
                                <div style="margin-bottom: 15px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                        <span style="font-weight: 600; font-size: 13px; min-width: 40px;">Q${s.qId}</span>
                                        <span style="font-weight: 700; color: ${barColor}; margin-left: 10px; min-width: 35px;">å¹³å‡: ${s.avg.toFixed(2)}</span>
                                        <span style="font-size: 12px; color: #999; margin-left: 10px; min-width: 50px;">æ¨™å·®: ${v.std_dev.toFixed(2)}</span>
                                    </div>
                                    <div style="background: #e0e0e0; height: 20px; border-radius: 4px; overflow: hidden; flex-grow: 1;">
                                        <div style="background: ${barColor}; height: 100%; width: ${barWidth}%; border-radius: 4px;"></div>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-top: 6px; font-size: 11px; color: #999;">
                                        <span>â‘ ${d['1'] || 0}</span>
                                        <span>â‘¡${d['2'] || 0}</span>
                                        <span>â‘¢${d['3'] || 0}</span>
                                        <span>â‘£${d['4'] || 0}</span>
                                        <span>â‘¤${d['5'] || 0}</span>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>

                <div class="insight-box" style="background: #e7f3ff; border-left: 4px solid #0066cc; padding: 15px; border-radius: 4px;">
                    <div class="insight-title" style="color: #0066cc; margin-bottom: 8px;">åˆ†æãƒã‚¤ãƒ³ãƒˆ</div>
                    <div class="insight-text" style="color: #0066cc; font-size: 13px; line-height: 1.6;">
                        â€¢ å¹³å‡ã‚¹ã‚³ã‚¢ãŒä½ã„ï¼ˆ3ä»¥ä¸‹ï¼‰è¨­å•ã¯ã€çµ„ç¹”å†…ã§ç†è§£ãƒ»èªè­˜ãŒä¸è¶³ã—ã¦ã„ã‚‹å¯èƒ½æ€§<br>
                        â€¢ æ¨™æº–åå·®ãŒå¤§ãã„è¨­å•ã¯ã€å›ç­”è€…é–“ã§ã®ã‚ºãƒ¬ãŒå¤§ãã„ï¼ˆå®šç¾©ãŒçµ±ä¸€ã•ã‚Œã¦ã„ãªã„ï¼‰<br>
                        â€¢ â‘ â‘¡ã®å›ç­”è€…ãŒå¤šã„è¨­å•ã¯ã€Œåˆ¤æ–­ãŒã¤ã‹ãªã„ã€çŠ¶æ…‹ãŒå¤šã„ã“ã¨ã‚’ç¤ºå”†
                    </div>
                </div>
            `;
        }

        function generateQuestionDetail(respondents, qIdx) {
            const q = surveyQuestions[qIdx];
            const scores = respondents.map(r => parseInt(r.answers[qIdx].rating));
            const avgScore = scores.reduce((a, b) => a + b) / scores.length;

            const examples = respondents.slice(0, 3).map((r, i) => `
                <div style="margin-bottom: 10px; padding: 8px; background-color: white; border-left: 3px solid #ff6b6b;">
                    <strong>${r.name}</strong> (ã‚¹ã‚³ã‚¢: ${r.answers[qIdx].rating})<br>
                    ã€Œ${r.answers[qIdx].text}ã€
                </div>
            `).join('');

            const distrib = [1,2,3,4,5].map(rating => scores.filter(s => s === rating).length);

            return `
                <div class="slide-section">
                    <div class="slide-subtitle">${q.title}</div>
                    <div class="stat-box">
                        <div class="stat-item">
                            <div class="stat-label">å¹³å‡ã‚¹ã‚³ã‚¢</div>
                            <div class="stat-value">${avgScore.toFixed(1)}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">å›ç­”æ•°</div>
                            <div class="stat-value">${respondents.length}</div>
                        </div>
                    </div>
                </div>

                <div class="slide-section">
                    <div class="slide-subtitle">å›ç­”åˆ†å¸ƒ</div>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-bottom: 15px;">
                        ${[1,2,3,4,5].map((r, i) => `
                            <div style="text-align: center; padding: 10px; background-color: #f0f8ff; border-radius: 4px;">
                                <div style="font-weight: 600; color: #1f4788;">â‘¤${r}</div>
                                <div style="font-size: 18px; font-weight: 700;">${distrib[i]}</div>
                                <div style="font-size: 11px; color: #666;">${(distrib[i]/respondents.length*100).toFixed(0)}%</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="slide-section">
                    <div class="slide-subtitle">ä»£è¡¨å›ç­”ä¾‹</div>
                    ${examples}
                </div>
            `;
        }

        function generateDepartmentComparison(respondents) {
            const departments = ['å–¶æ¥­éƒ¨', 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', 'ä¼ç”»éƒ¨'];
            const deptData = {};

            departments.forEach(dept => {
                const deptRes = respondents.filter(r => r.department === dept);
                deptData[dept] = calculateAverageScores(deptRes);
            });

            return `
                <div class="slide-section">
                    <div class="slide-subtitle">éƒ¨ç½²åˆ¥å¹³å‡ã‚¹ã‚³ã‚¢æ¯”è¼ƒ</div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <div style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; margin-bottom: 15px;">
                            <div style="font-weight: 700; font-size: 12px; padding: 10px; background: #1f4788; color: white; border-radius: 4px; text-align: center;">éƒ¨ç½²</div>
                            <div style="font-weight: 700; font-size: 12px; padding: 10px; background: #1f4788; color: white; border-radius: 4px; text-align: center;">Q1</div>
                            <div style="font-weight: 700; font-size: 12px; padding: 10px; background: #1f4788; color: white; border-radius: 4px; text-align: center;">Q2</div>
                            <div style="font-weight: 700; font-size: 12px; padding: 10px; background: #1f4788; color: white; border-radius: 4px; text-align: center;">Q3</div>
                            <div style="font-weight: 700; font-size: 12px; padding: 10px; background: #1f4788; color: white; border-radius: 4px; text-align: center;">Q4</div>
                            <div style="font-weight: 700; font-size: 12px; padding: 10px; background: #1f4788; color: white; border-radius: 4px; text-align: center;">Q5</div>
                            ${departments.map(dept => {
                                const data = deptData[dept];
                                const avg = data.reduce((a, b) => a + b.avg, 0) / 5;
                                return `
                                    <div style="padding: 10px; background: white; border-radius: 4px; border-left: 3px solid #ff6b6b; font-weight: 600; font-size: 12px;">${dept}</div>
                                    ${data.map((d, i) => {
                                        const color = d.avg >= 4 ? '#28a745' : d.avg >= 3 ? '#ffc107' : '#dc3545';
                                        return `<div style="padding: 10px; background: white; border-radius: 4px; text-align: center; font-weight: 700; color: ${color};">${d.avg.toFixed(1)}</div>`;
                                    }).join('')}
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>

                <div class="insight-box" style="background: #f0f0f0; border-left: 4px solid #555; padding: 15px; border-radius: 4px;">
                    <div class="insight-title" style="color: #333; margin-bottom: 8px;">éƒ¨ç½²é–“ã‚ºãƒ¬ã®åˆ†æ</div>
                    <div class="insight-text" style="color: #333; font-size: 13px; line-height: 1.6;">
                        â€¢ éƒ¨ç½²é–“ã§1.5ç‚¹ä»¥ä¸Šã®å·®ãŒã‚ã‚‹è¨­å•ã¯ã€éƒ¨ç½²é–“ã§ã®ç†è§£ã‚®ãƒ£ãƒƒãƒ—ãŒã‚ã‚‹å¯èƒ½æ€§<br>
                        â€¢ ç‰¹ã«å–¶æ¥­éƒ¨ã¨ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨ãƒ»ä¼ç”»éƒ¨ã®å·®ãŒå¤§ãã„å ´åˆã¯ã€ç¾å ´ã¨ä¼ç”»å±¤ã®ä¹–é›¢ã‚’ç¤ºå”†
                    </div>
                </div>
            `;
        }

        function generateQuadrantMap(respondents) {
            const respondentData = respondents.map(r => ({
                name: r.name,
                q1: parseInt(r.answers[0].rating),
                q3: parseInt(r.answers[2].rating)
            }));

            const quadrants = {
                high_soft_high_consensus: respondentData.filter(r => r.q1 >= 4 && r.q3 >= 4),
                high_soft_low_consensus: respondentData.filter(r => r.q1 >= 4 && r.q3 < 4),
                low_soft_high_consensus: respondentData.filter(r => r.q1 < 4 && r.q3 >= 4),
                low_soft_low_consensus: respondentData.filter(r => r.q1 < 4 && r.q3 < 4)
            };

            return `
                <div class="slide-section">
                    <div class="slide-subtitle">4è±¡é™ãƒãƒƒãƒ—ï¼ˆQ1å®šç¾©æ˜ç¢ºã• Ã— Q3å…±é€šè¨€èªåº¦ï¼‰</div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="background-color: #c8e6c9; padding: 15px; border-radius: 4px;">
                        <div style="font-weight: 600; margin-bottom: 10px;">âœ… å®šç¾©æ˜ç¢ºï¼†å…±é€šè¨€èª</div>
                        <div style="font-size: 12px;">${quadrants.high_soft_high_consensus.map(r => r.name).join(', ')}</div>
                        <div style="font-size: 13px; font-weight: 600; margin-top: 5px;">${quadrants.high_soft_high_consensus.length}å</div>
                    </div>

                    <div style="background-color: #fff9c4; padding: 15px; border-radius: 4px;">
                        <div style="font-weight: 600; margin-bottom: 10px;">âš ï¸ å®šç¾©æ˜ç¢ºã ãŒè¨€èªãŒãƒãƒ©ãƒãƒ©</div>
                        <div style="font-size: 12px;">${quadrants.high_soft_low_consensus.map(r => r.name).join(', ')}</div>
                        <div style="font-size: 13px; font-weight: 600; margin-top: 5px;">${quadrants.high_soft_low_consensus.length}å</div>
                    </div>

                    <div style="background-color: #ffccbc; padding: 15px; border-radius: 4px;">
                        <div style="font-weight: 600; margin-bottom: 10px;">âš ï¸ å®šç¾©ãŒæ›–æ˜§ã ãŒè¨€èªã¯çµ±ä¸€</div>
                        <div style="font-size: 12px;">${quadrants.low_soft_high_consensus.map(r => r.name).join(', ')}</div>
                        <div style="font-size: 13px; font-weight: 600; margin-top: 5px;">${quadrants.low_soft_high_consensus.length}å</div>
                    </div>

                    <div style="background-color: #ffcdd2; padding: 15px; border-radius: 4px;">
                        <div style="font-weight: 600; margin-bottom: 10px;">ğŸ”´ å®šç¾©æ›–æ˜§ï¼†è¨€èªãƒãƒ©ãƒãƒ©</div>
                        <div style="font-size: 12px;">${quadrants.low_soft_low_consensus.map(r => r.name).join(', ')}</div>
                        <div style="font-size: 13px; font-weight: 600; margin-top: 5px;">${quadrants.low_soft_low_consensus.length}å</div>
                    </div>
                </div>
            `;
        }

        function generateBoxPlotAnalysis(respondents) {
            const departments = ['å–¶æ¥­éƒ¨', 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', 'ä¼ç”»éƒ¨'];
            let html = '<div class="slide-section"><div class="slide-subtitle">éƒ¨ç½²åˆ¥ã°ã‚‰ã¤ãåˆ†æï¼ˆBox Plotï¼‰</div>';

            departments.forEach(dept => {
                const deptRes = respondents.filter(r => r.department === dept);
                const variance = calculateVariance(deptRes);

                html += `
                    <div style="margin-bottom: 15px; padding: 10px; background-color: #f9f9f9; border-radius: 4px;">
                        <div style="font-weight: 600; margin-bottom: 10px;">${dept}</div>
                        <table class="comparison-table" style="margin: 0;">
                            <tr>
                                <th>Q</th>
                                <th>å¹³å‡</th>
                                <th>æ¨™æº–åå·®</th>
                                <th>ã°ã‚‰ã¤ãåº¦</th>
                            </tr>
                            ${variance.map(v => `
                                <tr>
                                    <td>Q${v.qId}</td>
                                    <td>${v.avg.toFixed(2)}</td>
                                    <td>${v.std_dev.toFixed(2)}</td>
                                    <td>${v.variance > 1.5 ? 'é«˜' : v.variance > 0.8 ? 'ä¸­' : 'ä½'}</td>
                                </tr>
                            `).join('')}
                        </table>
                    </div>
                `;
            });

            html += `
                <div class="insight-box">
                    <div class="insight-title">ã°ã‚‰ã¤ãåˆ†æã®æ„å‘³</div>
                    <div class="insight-text">
                        â€¢ æ¨™æº–åå·®ãŒå¤§ãã„ = éƒ¨ç½²å†…ã§ã‚‚å›ç­”ãŒãƒãƒ©ãƒãƒ© = ç†è§£ã‚„èªè­˜ãŒã¾ã¡ã¾ã¡<br>
                        â€¢ ç‰¹ã«å–¶æ¥­éƒ¨ã¨ä¼ç”»éƒ¨ã§ã°ã‚‰ã¤ããŒç•°ãªã‚‹å ´åˆã€æ€è€ƒæ–¹æ³•ã‚„å„ªå…ˆåº¦ã®å·®ã‚’ç¤ºå”†
                    </div>
                </div>
            `;

            return html + '</div>';
        }

        function generateNoDecisionAnalysis(respondents) {
            const lowDecisionCount = respondents.reduce((sum, r) => {
                const lowRatings = r.answers.filter(a => parseInt(a.rating) <= 2).length;
                return sum + lowRatings;
            }, 0);

            const totalAnswers = respondents.length * 5;
            const lowDecisionRatio = (lowDecisionCount / totalAnswers * 100).toFixed(1);

            return `
                <div class="slide-section">
                    <div class="slide-subtitle">åˆ¤æ–­åº¦ã®ä½ã•ï¼ˆâ‘ â‘¡ã®å›ç­”æ¯”ç‡ï¼‰</div>
                    <div class="stat-box">
                        <div class="stat-item">
                            <div class="stat-label">ä½åˆ¤æ–­åº¦ã®å›ç­”</div>
                            <div class="stat-value">${lowDecisionCount}ä»¶</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">å…¨å›ç­”ã«å ã‚ã‚‹å‰²åˆ</div>
                            <div class="stat-value">${lowDecisionRatio}%</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">åˆ¤å®š</div>
                            <div class="stat-value" style="font-size: 14px; color: ${lowDecisionRatio > 30 ? '#dc3545' : '#28a745'}">
                                ${lowDecisionRatio > 30 ? 'é«˜ãƒªã‚¹ã‚¯' : 'æ­£å¸¸'}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="insight-box">
                    <div class="insight-title">åˆ¤å®šåŸºæº–</div>
                    <div class="insight-text">
                        â€¢ ä½åˆ¤æ–­åº¦æ¯”ç‡ &gt; 30% = ã€Œä½•ã‚’è¨€ã†ã¹ãã‹åˆ†ã‹ã‚‰ãªã„ã€çŠ¶æ…‹ãŒå¤šã„<br>
                        â€¢ ã“ã®ã‚ˆã†ãªçŠ¶æ³ä¸‹ã§ã¯ã€çµŒå–¶çš„ãªæ„æ€æ±ºå®šãŒé›£ã—ã„å¯èƒ½æ€§ãŒã‚ã‚‹<br>
                        â€¢ ç‰¹ã«å–¶æ¥­éƒ¨ã§ã“ã®å‚¾å‘ãŒå¼·ã„å ´åˆã€é¡§å®¢å¯¾å¿œã«æ”¯éšœãŒå‡ºã‚‹å¯èƒ½æ€§
                    </div>
                </div>
            `;
        }

        function generateActionPlan(respondents) {
            const avgScores = calculateAverageScores(respondents);
            const variance = calculateVariance(respondents);
            const actions = [];

            variance.forEach(v => {
                if (v.variance > 1.5) {
                    actions.push(`Q${v.qId}ã®ã°ã‚‰ã¤ããŒå¤§ãã„ â†’ ã€Œå®šç¾©å…±æœ‰ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã€ã‚’é–‹å‚¬ã—ã€ãƒãƒ¼ãƒ å†…ã§ã€Œä¸€è¨€å®šç¾©ã€ã‚’çµ±ä¸€ã™ã‚‹`);
                }
            });

            avgScores.forEach(s => {
                if (s.avg < 3) {
                    actions.push(`Q${s.qId}ã®å¹³å‡ã‚¹ã‚³ã‚¢ãŒä½ã„ â†’ ç†è§£åº¦å‘ä¸Šãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä¼ç”»ã—ã€æ®µéšçš„ã«èªè­˜ã‚’é«˜ã‚ã‚‹`);
                }
            });

            const depts = ['å–¶æ¥­éƒ¨', 'ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨', 'ä¼ç”»éƒ¨'];
            depts.forEach(dept => {
                const deptRes = respondents.filter(r => r.department === dept);
                const deptAvg = calculateAverageScores(deptRes).reduce((a, b) => a + b.avg, 0) / 5;
                if (deptAvg < 3) {
                    actions.push(`${dept}ã®å…¨ä½“ã‚¹ã‚³ã‚¢ãŒä½ã„ â†’ ${dept}å‘ã‘ã®é›†ä¸­ç ”ä¿®ã‚„æƒ…å ±å…±æœ‰ã®å ´ã‚’å¢—ã‚„ã™`);
                }
            });

            if (actions.length === 0) {
                actions.push('çµ„ç¹”å…¨ä½“ã®ç†è§£åº¦ãŒä¸€å®šæ°´æº–ã«é”ã—ã¦ã„ã‚‹ãŸã‚ã€ç¶™ç¶šçš„ãªãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã¨æ”¹å–„ã‚’æ¨å¥¨ã—ã¾ã™');
            }

            return `
                <div class="slide-section">
                    <div class="slide-subtitle">æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</div>
                    <ul class="action-list">
                        ${actions.map(a => `<li>${a}</li>`).join('')}
                    </ul>
                </div>

                <div class="insight-box">
                    <div class="insight-title">å®Ÿè¡Œã®ãƒã‚¤ãƒ³ãƒˆ</div>
                    <div class="insight-text">
                        â€¢ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å„ªå…ˆé †ä½ï¼šã°ã‚‰ã¤ãæ”¹å–„ â†’ ã‚¹ã‚³ã‚¢å‘ä¸Š â†’ éƒ¨ç½²é–“æ ¼å·®è§£æ¶ˆ<br>
                        â€¢ å®Ÿè¡ŒæœŸé–“ï¼šçŸ­æœŸï¼ˆ1-3ãƒ¶æœˆï¼‰â†’ ä¸­æœŸï¼ˆ3-6ãƒ¶æœˆï¼‰â†’ é•·æœŸï¼ˆ6-12ãƒ¶æœˆï¼‰ã§æ®µéšå®Ÿæ–½<br>
                        â€¢ åŠ¹æœæ¸¬å®šï¼š3ãƒ¶æœˆå¾Œã«å†èª¿æŸ»å®Ÿæ–½ã—ã€ã‚¹ã‚³ã‚¢æ”¹å–„ã‚’ç¢ºèª
                    </div>
                </div>
            `;
        }

        function generateRespondentDetails(respondents) {
            let html = '<div class="slide-section"><div class="slide-subtitle">å€‹äººåˆ¥å›ç­”è©³ç´°</div>';
            html += '<table class="comparison-table"><tr>';
            html += '<th>æ°å</th><th>éƒ¨ç½²</th>';
            for (let i = 0; i < 5; i++) {
                html += `<th>Q${i+1}</th>`;
            }
            html += '</tr>';

            respondents.forEach(r => {
                html += `<tr><td>${r.name}</td><td>${r.department}</td>`;
                r.answers.forEach(a => {
                    html += `<td>${a.rating}</td>`;
                });
                html += '</tr>';
            });

            html += '</table></div>';
            return html;
        }

        // ========================================
        // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
        // ========================================
        function calculateAverageScores(respondents) {
            const result = [];
            for (let i = 0; i < 5; i++) {
                const scores = respondents.map(r => parseInt(r.answers[i].rating));
                const avg = scores.reduce((a, b) => a + b) / scores.length;
                result.push({ qId: i + 1, avg });
            }
            return result;
        }

        function calculateVariance(respondents) {
            const result = [];
            for (let i = 0; i < 5; i++) {
                const scores = respondents.map(r => parseInt(r.answers[i].rating));
                const avg = scores.reduce((a, b) => a + b) / scores.length;
                const variance = scores.reduce((sum, s) => sum + Math.pow(s - avg, 2), 0) / scores.length;
                const std_dev = Math.sqrt(variance);
                result.push({ qId: i + 1, avg, variance, std_dev });
            }
            return result;
        }

        function calculateDistribution(respondents) {
            const result = {};
            for (let i = 0; i < 5; i++) {
                result[i + 1] = {};
                respondents.forEach(r => {
                    const rating = r.answers[i].rating;
                    result[i + 1][rating] = (result[i + 1][rating] || 0) + 1;
                });
            }
            return result;
        }

        function renderSlide(slide) {
            const content = document.getElementById('slideContent');
            content.innerHTML = `
                <div class="slide-title">${slide.title}</div>
                ${slide.html}
            `;
            document.getElementById('slideCounter').textContent = currentSlide;
        }

        function nextSlide() {
            if (currentSlide < allSlides.length) {
                currentSlide++;
                renderSlide(allSlides[currentSlide - 1]);
            }
        }

        function previousSlide() {
            if (currentSlide > 1) {
                currentSlide--;
                renderSlide(allSlides[currentSlide - 1]);
            }
        }

        // ========================================
        // PDF ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        // ========================================
        function downloadReportPDF() {
            const companyObj = companies.find(c => c.id === currentCompanyId);
            const company = companyObj ? companyObj.name : currentCompanyId;
            const container = document.createElement('div');

            // å…¨ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ã‚³ãƒ³ãƒ†ãƒŠã«è¿½åŠ 
            allSlides.forEach(slide => {
                const slideDiv = document.createElement('div');
                slideDiv.style.pageBreakAfter = 'always';
                slideDiv.innerHTML = `
                    <div class="slide-content">
                        <div class="slide-title">${slide.title}</div>
                        ${slide.html}
                    </div>
                `;
                container.appendChild(slideDiv);
            });

            const opt = {
                margin: 10,
                filename: `${company}_report_${new Date().toISOString().split('T')[0]}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };
            html2pdf().set(opt).from(container).save();
        }

        function downloadReportSlides() {
            const companyObj = companies.find(c => c.id === currentCompanyId);
            const company = companyObj ? companyObj.name : currentCompanyId;
            const container = document.createElement('div');

            allSlides.forEach(slide => {
                const slideDiv = document.createElement('div');
                slideDiv.style.pageBreakAfter = 'always';
                slideDiv.innerHTML = `
                    <div class="slide-content">
                        <div class="slide-title">${slide.title}</div>
                        ${slide.html}
                    </div>
                `;
                container.appendChild(slideDiv);
            });

            const opt = {
                margin: 10,
                filename: `${company}_slides_${new Date().toISOString().split('T')[0]}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
            };
            html2pdf().set(opt).from(container).save();
        }

        // ========================================
        // Google Slides ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        // ========================================
        function exportToGoogleSlides() {
            const companyObj = companies.find(c => c.id === currentCompanyId);
            const company = companyObj ? companyObj.name : currentCompanyId;

            // å‡¦ç†ä¸­ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            alert('Google Slides ã‚’ä½œæˆä¸­ã§ã™ã€‚å°‘ã€…ãŠå¾…ã¡ãã ã•ã„...');

            // Apps Script ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡
            const deploymentId = 'AKfycbxGy0MWeCB6b1X4GbHxeRmWfSsVJSF1v8JXYwiUCkl860FITPF0NzxFyvYNtXoYIr0o';
            const appsScriptUrl = `https://script.google.com/macros/d/${deploymentId}/usercontent`;

            // é€ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™
            const dataToSend = {
                company: company,
                slides: allSlides
            };

            // Apps Script ã« POST ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
            fetch(appsScriptUrl, {
                method: 'POST',
                body: JSON.stringify(dataToSend),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    // Google Slides ã®ãƒªãƒ³ã‚¯ã‚’æ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§é–‹ã
                    alert('âœ… Google Slides ãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼\n\næ–°ã—ã„ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‹ãã¾ã™ã€‚');
                    window.open(result.presentationUrl, '_blank');
                } else {
                    alert('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸï¼š\n' + result.error);
                }
            })
            .catch(error => {
                alert('âŒ é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸï¼š\n' + error.toString());
                console.error('Error:', error);
            });
        }

        // ========================================
        // ã‚µãƒ¼ãƒ™ã‚¤ãƒ¢ãƒ¼ãƒ‰
        // ========================================
        function initializeSurveyMode() {
            const companyId = new URLSearchParams(window.location.search).get('company');
            const linkId = new URLSearchParams(window.location.search).get('linkId');
            currentCompanyId = companyId || 'sample-corp';
            isAdminMode = false;
            currentQuestionIndex = -1; // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å…¥åŠ›ç”»é¢ã‹ã‚‰é–‹å§‹

            document.body.innerHTML = `
                <div style="background-color: #f5f5f5; min-height: 100vh; padding: 40px 20px;">
                    <div style="max-width: 600px; margin: 0 auto; background-color: white; border-radius: 8px; padding: 40px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <h1 style="color: #1f4788; margin-bottom: 10px;">CharmSurvey</h1>
                            <p style="color: #666; font-size: 14px;">çµ„ç¹”ã‚µãƒ¼ãƒ™ã‚¤ã«ã”å”åŠ›ãã ã•ã„</p>
                        </div>

                        <div id="surveyContainer"></div>
                    </div>
                </div>
            `;

            renderSurveyQuestions();
        }

        function renderSurveyQuestions() {
            const container = document.getElementById('surveyContainer');

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å…¥åŠ›ç”»é¢
            if (currentQuestionIndex === -1) {
                container.innerHTML = `
                    <div style="margin-bottom: 20px;">
                        <h2 style="color: #1f4788; font-size: 16px; margin-bottom: 20px;">ã”å›ç­”è€…æƒ…å ±ã‚’ã”å…¥åŠ›ãã ã•ã„</h2>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">æ°å <span style="color: #ff6b6b;">*</span></label>
                            <input type="text" id="respondentName" placeholder="ä¾‹ï¼šç”°ä¸­å¤ªéƒ" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; font-size: 14px;">
                        </div>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">éƒ¨ç½²</label>
                            <input type="text" id="respondentDepartment" placeholder="ä¾‹ï¼šå–¶æ¥­éƒ¨" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; font-size: 14px;">
                        </div>

                        <div style="margin-bottom: 15px;">
                            <label style="display: block; font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">å½¹è·</label>
                            <input type="text" id="respondentPosition" placeholder="ä¾‹ï¼šå–¶æ¥­èª²é•·" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; font-size: 14px;">
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label style="display: block; font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px;">å…¥ç¤¾æ—¥</label>
                            <input type="date" id="respondentJoinDate" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; font-size: 14px;">
                        </div>

                        <button class="btn btn-primary" onclick="startSurvey()" style="width: 100%; padding: 12px; font-size: 15px;">ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã‚’é–‹å§‹ â†’</button>
                    </div>
                `;
                return;
            }

            const q = surveyQuestions[currentQuestionIndex];

            if (!q) {
                container.innerHTML = '<p style="text-align: center; color: #28a745; font-size: 16px; font-weight: 600;">ã”å›ç­”ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</p>';
                return;
            }

            const progress = ((currentQuestionIndex + 1) / 5) * 100;

            container.innerHTML = `
                <div style="width: 100%; height: 8px; background-color: #e8e8e8; border-radius: 4px; overflow: hidden; margin-bottom: 10px;">
                    <div style="height: 100%; background-color: #1f4788; width: ${progress}%; transition: width 0.3s;"></div>
                </div>
                <p style="text-align: center; font-size: 12px; color: #999; margin-bottom: 20px;">${currentQuestionIndex + 1} / 5</p>

                <div class="question-block">
                    <div class="question-label">Q${q.id}: ${q.title}</div>

                    <div style="margin: 20px 0;">
                        <label style="font-size: 12px; color: #666; margin-bottom: 10px; display: block;">${q.textQuestion}</label>
                        <textarea id="textAnswer" maxlength="${q.textMaxLength}" style="width: 100%; min-height: 80px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit;"></textarea>
                        <div style="font-size: 11px; color: #999; margin-top: 5px;">æœ€å¤§${q.textMaxLength}æ–‡å­—</div>
                    </div>

                    <div style="margin: 20px 0;">
                        <label style="font-size: 12px; color: #666; margin-bottom: 10px; display: block;">${q.ratingQuestion}</label>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 8px;">
                            ${q.ratingOptions.map((opt, idx) => `
                                <label style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; text-align: center; cursor: pointer; transition: all 0.3s; font-size: 12px;">
                                    <input type="radio" name="rating" value="${idx + 1}" style="margin-right: 5px;">
                                    ${opt}
                                </label>
                            `).join('')}
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn btn-secondary" onclick="previousQuestion()" style="flex: 1; ${currentQuestionIndex === 0 ? 'opacity: 0.5; cursor: not-allowed;' : ''}">â† å‰ã¸</button>
                        <button class="btn btn-primary" onclick="nextQuestion()" style="flex: 1;">
                            ${currentQuestionIndex === 4 ? 'å®Œäº†' : 'æ¬¡ã¸ â†’'}
                        </button>
                    </div>
                </div>
            `;
        }

        function startSurvey() {
            const name = document.getElementById('respondentName').value.trim();
            const department = document.getElementById('respondentDepartment').value.trim();

            if (!name) {
                alert('æ°åã¯å¿…é ˆé …ç›®ã§ã™');
                return;
            }

            const position = document.getElementById('respondentPosition').value.trim();
            const joinDate = document.getElementById('respondentJoinDate').value;

            surveyResponses = [{
                name: name,
                department: department,
                position: position,
                joinDate: joinDate || new Date().toISOString().split('T')[0],
                answers: []
            }];

            currentQuestionIndex = 0;
            renderSurveyQuestions();
        }

        function nextQuestion() {
            const textAnswer = document.getElementById('textAnswer').value;
            const ratingAnswer = document.querySelector('input[name="rating"]:checked');

            if (!textAnswer.trim() || !ratingAnswer) {
                alert('ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            if (!surveyResponses[0]) {
                surveyResponses = [{
                    name: '',
                    department: '',
                    position: '',
                    joinDate: new Date().toISOString().split('T')[0],
                    answers: []
                }];
            }

            surveyResponses[0].answers.push({
                questionId: currentQuestionIndex + 1,
                text: textAnswer,
                rating: ratingAnswer.value
            });

            currentQuestionIndex++;
            if (currentQuestionIndex >= 5) {
                saveSurveyResponse();
            } else {
                renderSurveyQuestions();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderSurveyQuestions();
            }
        }

        function saveSurveyResponse() {
            const linkId = new URLSearchParams(window.location.search).get('linkId') || 'link-default';
            const existing = JSON.parse(localStorage.getItem(`respondents_${currentCompanyId}`) || '[]');
            existing.push({
                name: surveyResponses[0].name,
                department: surveyResponses[0].department,
                position: surveyResponses[0].position,
                joinDate: surveyResponses[0].joinDate,
                surveyLinkId: linkId,
                answers: surveyResponses[0].answers
            });
            localStorage.setItem(`respondents_${currentCompanyId}`, JSON.stringify(existing));
            renderSurveyQuestions();
        }

        // ========================================
        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰
        // ========================================
        window.addEventListener('DOMContentLoaded', init);
    </script>


</body></html>